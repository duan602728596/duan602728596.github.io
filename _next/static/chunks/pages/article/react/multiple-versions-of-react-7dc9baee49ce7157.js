(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5312],{38925:function(e,n,t){"use strict";t.d(n,{Z:function(){return M}});var o=t(76278),r=t(41322),a=t(84481),i=t(26702),c=t(1558),s=t(94184),l=t.n(s),d=t(82225),u=t(64217),p=t(67294),m=t(96159),h=t(53124),f=t(14747),g=t(67968),v=t(45503);let x=(e,n,t,o,r)=>({backgroundColor:e,border:`${o.lineWidth}px ${o.lineType} ${n}`,[`${r}-icon`]:{color:t}}),y=e=>{let{componentCls:n,motionDurationSlow:t,marginXS:o,marginSM:r,fontSize:a,fontSizeLG:i,lineHeight:c,borderRadiusLG:s,motionEaseInOutCirc:l,alertIconSizeLG:d,colorText:u,paddingContentVerticalSM:p,alertPaddingHorizontal:m,paddingMD:h,paddingContentHorizontalLG:g,colorTextHeading:v}=e;return{[n]:Object.assign(Object.assign({},(0,f.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:`${p}px ${m}px`,wordWrap:"break-word",borderRadius:s,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-content`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:o,lineHeight:0},"&-description":{display:"none",fontSize:a,lineHeight:c},"&-message":{color:u},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${t} ${l}, opacity ${t} ${l},
        padding-top ${t} ${l}, padding-bottom ${t} ${l},
        margin-bottom ${t} ${l}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${n}-with-description`]:{alignItems:"flex-start",paddingInline:g,paddingBlock:h,[`${n}-icon`]:{marginInlineEnd:r,fontSize:d,lineHeight:0},[`${n}-message`]:{display:"block",marginBottom:o,color:v,fontSize:i},[`${n}-description`]:{display:"block"}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},j=e=>{let{componentCls:n,colorSuccess:t,colorSuccessBorder:o,colorSuccessBg:r,colorWarning:a,colorWarningBorder:i,colorWarningBg:c,colorError:s,colorErrorBorder:l,colorErrorBg:d,colorInfo:u,colorInfoBorder:p,colorInfoBg:m}=e;return{[n]:{"&-success":x(r,o,t,e,n),"&-info":x(m,p,u,e,n),"&-warning":x(c,i,a,e,n),"&-error":Object.assign(Object.assign({},x(d,l,s,e,n)),{[`${n}-description > pre`]:{margin:0,padding:0}})}}},b=e=>{let{componentCls:n,iconCls:t,motionDurationMid:o,marginXS:r,fontSizeIcon:a,colorIcon:i,colorIconHover:c}=e;return{[n]:{"&-action":{marginInlineStart:r},[`${n}-close-icon`]:{marginInlineStart:r,padding:0,overflow:"hidden",fontSize:a,lineHeight:`${a}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${t}-close`]:{color:i,transition:`color ${o}`,"&:hover":{color:c}}},"&-close-text":{color:i,transition:`color ${o}`,"&:hover":{color:c}}}}},w=e=>[y(e),j(e),b(e)];var C=(0,g.Z)("Alert",e=>{let{fontSizeHeading3:n}=e,t=(0,v.TS)(e,{alertIconSizeLG:n,alertPaddingHorizontal:12});return[w(t)]}),k=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&0>n.indexOf(o)&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)0>n.indexOf(o[r])&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]]);return t};let _={success:o.Z,info:c.Z,error:r.Z,warning:i.Z},E=e=>{let{icon:n,prefixCls:t,type:o}=e,r=_[o]||null;return n?(0,m.wm)(n,p.createElement("span",{className:`${t}-icon`},n),()=>({className:l()(`${t}-icon`,{[n.props.className]:n.props.className})})):p.createElement(r,{className:`${t}-icon`})},N=e=>{let{isClosable:n,prefixCls:t,closeIcon:o,handleClose:r}=e,i=!0===o||void 0===o?p.createElement(a.Z,null):o;return n?p.createElement("button",{type:"button",onClick:r,className:`${t}-close-icon`,tabIndex:0},i):null};var L=e=>{let{description:n,prefixCls:t,message:o,banner:r,className:a,rootClassName:i,style:c,onMouseEnter:s,onMouseLeave:m,onClick:f,afterClose:g,showIcon:v,closable:x,closeText:y,closeIcon:j,action:b}=e,w=k(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),[_,L]=p.useState(!1),R=p.useRef(null),{getPrefixCls:Z,direction:$,alert:S}=p.useContext(h.E_),T=Z("alert",t),[M,P]=C(T),O=n=>{var t;L(!0),null===(t=e.onClose)||void 0===t||t.call(e,n)},I=p.useMemo(()=>void 0!==e.type?e.type:r?"warning":"info",[e.type,r]),z=p.useMemo(()=>!!y||("boolean"==typeof x?x:!1!==j&&null!=j),[y,j,x]),D=!!r&&void 0===v||v,H=l()(T,`${T}-${I}`,{[`${T}-with-description`]:!!n,[`${T}-no-icon`]:!D,[`${T}-banner`]:!!r,[`${T}-rtl`]:"rtl"===$},null==S?void 0:S.className,a,i,P),B=(0,u.Z)(w,{aria:!0,data:!0});return M(p.createElement(d.ZP,{visible:!_,motionName:`${T}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:g},t=>{let{className:r,style:a}=t;return p.createElement("div",Object.assign({ref:R,"data-show":!_,className:l()(H,r),style:Object.assign(Object.assign(Object.assign({},null==S?void 0:S.style),c),a),onMouseEnter:s,onMouseLeave:m,onClick:f,role:"alert"},B),D?p.createElement(E,{description:n,icon:e.icon,prefixCls:T,type:I}):null,p.createElement("div",{className:`${T}-content`},o?p.createElement("div",{className:`${T}-message`},o):null,n?p.createElement("div",{className:`${T}-description`},n):null),b?p.createElement("div",{className:`${T}-action`},b):null,p.createElement(N,{isClosable:z,prefixCls:T,closeIcon:y||j,handleClose:O}))}))},R=t(15671),Z=t(43144),$=t(32531),S=t(73568);let T=function(e){(0,$.Z)(t,e);var n=(0,S.Z)(t);function t(){var e;return(0,R.Z)(this,t),e=n.apply(this,arguments),e.state={error:void 0,info:{componentStack:""}},e}return(0,Z.Z)(t,[{key:"componentDidCatch",value:function(e,n){this.setState({error:e,info:n})}},{key:"render",value:function(){let{message:e,description:n,children:t}=this.props,{error:o,info:r}=this.state,a=r&&r.componentStack?r.componentStack:null,i=void 0===e?(o||"").toString():e;return o?p.createElement(L,{type:"error",message:i,description:p.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},void 0===n?a:n)}):t}}]),t}(p.Component);L.ErrorBoundary=T;var M=L},76278:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var o=t(87462),r=t(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},i=t(93771),c=r.forwardRef(function(e,n){return r.createElement(i.Z,(0,o.Z)({},e,{ref:n,icon:a}))})},26702:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var o=t(87462),r=t(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},i=t(93771),c=r.forwardRef(function(e,n){return r.createElement(i.Z,(0,o.Z)({},e,{ref:n,icon:a}))})},1558:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var o=t(87462),r=t(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},i=t(93771),c=r.forwardRef(function(e,n){return r.createElement(i.Z,(0,o.Z)({},e,{ref:n,icon:a}))})},37958:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var o=t(67294),r=t(9008),a=t.n(r),i=t(48726),c=t(38925),s=t(22410),l=t(30755),d=t(67552),u=t.n(d),p=t(85893),m=t(11151);function h(e){var n=u()({pre:"pre",code:"code"},(0,m.ah)(),e.components);return(0,p.jsx)(n.pre,{children:(0,p.jsx)(n.code,{className:"language-typescript",children:"import type { FunctionComponent, ComponentClass } from 'react';\nimport { render, unmountComponentAtNode } from 'react-dom';\n\ninterface CreateLegacyRoot {\n  render(props: any): void;\n  unmount(): void;\n}\n\ntype LegacyReturn = (container: HTMLElement) => CreateLegacyRoot;\n\n/**\n * 创建一个createLegacyRoot函数，保证组件能够兼容多个react版本\n * @param { FunctionComponent | ComponentClass } Component: 组件\n */\nfunction legacy(Component: FunctionComponent | ComponentClass): LegacyReturn {\n  return function createLegacyRoot(container: HTMLElement): CreateLegacyRoot {\n    return {\n      render(props: any): void {\n        render(<Component { ...props } />, container);\n      },\n      unmount(): void {\n        unmountComponentAtNode(container);\n      }\n    };\n  };\n}\n\nexport default legacy;\n"})})}var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,m.ah)(),e.components).wrapper;return n?(0,p.jsx)(n,u()({},e,{children:(0,p.jsx)(h,e)})):h(e)};function g(e){var n=u()({pre:"pre",code:"code"},(0,m.ah)(),e.components);return(0,p.jsx)(n.pre,{children:(0,p.jsx)(n.code,{className:"language-javascript",children:"import { useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * 加载联邦模块\n * @param { Function } props.loader: 加载的联邦模块\n * @param { object } props.moduleProps\n */\nfunction Loader(props) {\n  const { loader, moduleProps } = props;\n  const containerRef = useRef(), // dom，ReactDOM.render渲染的节点\n    rootRef = useRef(); // 保存root对象\n\n  // 加载并渲染模块\n  async function loadModule() {\n    const { createLegacyRoot } = await loader();\n\n    rootRef.current = createLegacyRoot(containerRef.current);\n    rootRef.current.render(moduleProps);\n  }\n\n  useEffect(function() {\n    loadModule();\n\n    return function() {\n      rootRef.current.unmount();\n    };\n  }, [loader, moduleProps]);\n\n  return <div ref={ containerRef } />;\n}\n\nLoader.propTypes = {\n  loader: PropTypes.func,\n  moduleProps: PropTypes.object\n};\n\nexport default Loader;\n"})})}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,m.ah)(),e.components).wrapper;return n?(0,p.jsx)(n,u()({},e,{children:(0,p.jsx)(g,e)})):g(e)};function x(e){var n=u()({pre:"pre",code:"code"},(0,m.ah)(),e.components);return(0,p.jsx)(n.pre,{children:(0,p.jsx)(n.code,{className:"language-javascript",children:"function App(props) {\n  function handleClick(event) {\n    alert('你点击了按钮。');\n  }\n\n  return (\n    <div>\n      <Loader loader={ () => import('project/module') }\n        moduleProps={{ onClick: handleClick }}\n      />\n    </div>\n  );\n}\n"})})}var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,m.ah)(),e.components).wrapper;return n?(0,p.jsx)(n,u()({},e,{children:(0,p.jsx)(x,e)})):x(e)},j=i.Z.Title,b=i.Z.Paragraph,w=i.Z.Text,C=function(e){return(0,p.jsxs)(s.Z,{children:[(0,p.jsx)(j,{children:"如何使用多版本的React"}),(0,p.jsxs)(b,{children:["在开发过程中使用联邦模块功能，使用其他项目的React组件，会出现\xa0",(0,p.jsx)(w,{type:"danger",children:"Minified React error #321;"}),"\xa0错误。这是由于多个版本的React导致的。"]}),(0,p.jsxs)(b,{children:[(0,p.jsx)("a",{href:"https://reactjs.org/blog/2020/08/10/react-v17-rc.html#changes-to-event-delegation",target:"_blank",rel:"noopener noreferrer",children:"在React@17中，事件系统进行了更改。"}),"这可以让我们使用React的多版本，解决多个版本的React导致的错误。"]}),(0,p.jsx)(j,{level:2,children:"导出组件出口"}),(0,p.jsx)(b,{children:"我们创建一个函数，来包裹我们需要导出的组件出口。"}),(0,p.jsx)(f,{}),(0,p.jsx)(b,{children:"然后导出一个方法，供其他位置调用。"}),(0,p.jsx)(l.Z,{type:"javascript",children:"export const createLegacyRoot = legacy(Component);"}),(0,p.jsx)(j,{level:2,children:"在其他项目调用方法"}),(0,p.jsx)(b,{children:"我们创建一个Loader函数，来加载导出的方法。"}),(0,p.jsx)(v,{}),(0,p.jsx)(b,{children:"然后加载组件并调用。"}),(0,p.jsx)(y,{}),(0,p.jsx)(c.Z,{type:"info",message:[(0,p.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,p.jsxs)("div",{className:"py-[8px]",children:["React多版本的Demo：",(0,p.jsx)("a",{href:"src/pages/article/react/MultipleVersionsOfReact/MultipleVersionsOfReact",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/reactjs/react-gradual-upgrade-demo/"})]},"react-gradual-upgrade-demo"),(0,p.jsxs)("div",{className:"py-[8px]",children:["webpack联邦模块官方文档：",(0,p.jsx)("a",{href:"src/pages/article/react/MultipleVersionsOfReact/MultipleVersionsOfReact",target:"_blank",rel:"noopener noreferrer",children:"https://webpack.js.org/concepts/module-federation/"})]},"webpack-module-federation")]})]})};function k(e){return(0,p.jsxs)(o.Fragment,{children:[(0,p.jsxs)(a(),{children:[(0,p.jsx)("title",{children:"如何使用多版本的React"}),(0,p.jsx)("meta",{name:"keywords",content:"前端, React, module-federation, 模块联邦"}),(0,p.jsx)("meta",{name:"description",content:"如何使用多版本的React"})]}),(0,p.jsx)(C,{})]})}},54892:function(e,n,t){"use strict";var o=t(19623),r=t(73935),a=t(11163),i=t(35846),c=t(97029),s=t(75162),l=t(37653),d=t(76467),u=t(3744),p=t.n(u),m=t(85893),h=i.Z.BackTop;n.Z=function(e){var n=(0,a.useRouter)();return[(0,m.jsxs)("div",{className:p().main,children:[e.goBack?(0,m.jsx)("div",{className:"mb-[16px] text-right",children:(0,m.jsxs)(c.ZP,{onClick:function(e){n.push("/")},children:[(0,m.jsx)(l.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,m.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,o.Z)(document))==="object"?(0,r.createPortal)((0,m.jsx)(h,{type:"primary",icon:(0,m.jsx)(s.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},34341:function(e,n,t){"use strict";t(74916);var o=t(88946),r=t.n(o),a=t(81290),i=t.n(a),c=t(41664),s=t.n(c),l=t(97183),d=t(42075),u=t(83062),p=t(67337),m=t(62139),h=t.n(m),f=t(30654),g=t(85893),v=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],x=["github.io","vercel.app"],y=r()(v).call(v,function(e,n){return(0,g.jsx)("li",{className:h().navListItem,children:(0,g.jsx)(s(),{href:e.href,children:e.title})},e.href)});n.Z=function(e){return(0,g.jsx)(l.Z.Header,{className:h().antdHeader,children:(0,g.jsxs)("div",{className:h().header,children:[(0,g.jsx)("nav",{className:h().headerLeft,children:(0,g.jsx)("ul",{className:h().navList,children:y})}),(0,g.jsx)("div",{className:h().headerRight,children:(0,g.jsxs)(d.Z,{size:16,children:[(0,g.jsx)(u.Z,{title:"切换网站地址",children:(0,g.jsx)("a",{className:h().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var n=window.location,t=n.pathname,o=n.hostname,r=/github\.io/.test(o);window.location.href=new(i())(t,"https://duan602728596.".concat(x[r?1:0],"/"))},children:(0,g.jsx)(p.Z,{className:h().switchAddressIcon})})}),(0,g.jsx)("a",{className:h().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,g.jsx)(f.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},30654:function(e,n,t){"use strict";var o=t(85893);n.Z=function(e){var n=e.className,t=e.imageClassName,r=e.avifSrc,a=e.webpSrc,i=e.src,c=e.alt;return(0,o.jsxs)("picture",{className:n,children:[r&&(0,o.jsx)("source",{srcSet:r,type:"image/avif"}),a&&(0,o.jsx)("source",{srcSet:a,type:"image/webp"}),(0,o.jsx)("img",{className:t,src:i,alt:c})]})}},22410:function(e,n,t){"use strict";var o=t(67294),r=t(34341),a=t(54892),i=t(85893);n.Z=function(e){return(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)(r.Z,{}),(0,i.jsx)(a.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},32230:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/react/multiple-versions-of-react",function(){return t(37958)}])},3744:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},62139:function(e){e.exports={antdHeader:"nav_antdHeader__eCvl0",header:"nav_header__y1mlw",headerLeft:"nav_headerLeft__PrT7_",headerRight:"nav_headerRight__JfqYP",navList:"nav_navList__3HXot",navListItem:"nav_navListItem__hpAdz",switchAddress:"nav_switchAddress__sVzqD",githubLink:"nav_githubLink__BDzSl",switchAddressIcon:"nav_switchAddressIcon__KLxGG"}},64217:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var o=t(1413),r="".concat("accept acceptCharset accessKey action allowFullScreen allowTransparency\n    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge\n    charSet checked classID className colSpan cols content contentEditable contextMenu\n    controls coords crossOrigin data dateTime default defer dir disabled download draggable\n    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder\n    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity\n    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media\n    mediaGroup method min minLength multiple muted name noValidate nonce open\n    optimum pattern placeholder poster preload radioGroup readOnly rel required\n    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected\n    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style\n    summary tabIndex target title type useMap value width wmode wrap"," ").concat("onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown\n    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick\n    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown\n    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel\n    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough\n    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata\n    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError").split(/[\s\n]+/);function a(e,n){return 0===e.indexOf(n)}function i(e){var n,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n=!1===t?{aria:!0,data:!0,attr:!0}:!0===t?{aria:!0}:(0,o.Z)({},t);var i={};return Object.keys(e).forEach(function(t){(n.aria&&("role"===t||a(t,"aria-"))||n.data&&a(t,"data-")||n.attr&&r.includes(t))&&(i[t]=e[t])}),i}}},function(e){e.O(0,[3576,7467,9166,9774,2888,179],function(){return e(e.s=32230)}),_N_E=e.O()}]);