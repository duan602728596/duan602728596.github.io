(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6764],{68795:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var a=t(1413),r=t(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},c=t(42135),i=function(e,n){return r.createElement(c.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:n,icon:l}))};i.displayName="SearchOutlined";var s=r.forwardRef(i)},32983:function(e,n,t){"use strict";t.d(n,{Z:function(){return S}});var a=t(4942),r=t(87462),l=t(97685),c=t(94184),i=t.n(c),s=t(67294),o=t(53124),u=t(23715),h=function(){return s.createElement("svg",{width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},s.createElement("g",{fill:"none",fillRule:"evenodd"},s.createElement("g",{transform:"translate(24 31.67)"},s.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),s.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),s.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),s.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),s.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),s.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),s.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},s.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),s.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},m=function(){return s.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},s.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},s.createElement("ellipse",{fill:"#F5F5F5",cx:"32",cy:"33",rx:"32",ry:"7"}),s.createElement("g",{fillRule:"nonzero",stroke:"#D9D9D9"},s.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),s.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:"#FAFAFA"}))))},d=t(67968),v=t(45503),f=function(e){var n,t=e.componentCls,r=e.margin,l=e.marginXS,c=e.marginXL,i=e.fontSizeBase,s=e.lineHeight;return(0,a.Z)({},t,(n={marginInline:l,fontSize:i,lineHeight:s,textAlign:"center"},(0,a.Z)(n,"".concat(t,"-image"),{height:e.emptyImgHeight,marginBottom:l,opacity:e.opacityImage,img:{height:"100%"},svg:{height:"100%",margin:"auto"}}),(0,a.Z)(n,"".concat(t,"-footer"),{marginTop:r}),(0,a.Z)(n,"&-normal",(0,a.Z)({marginBlock:c,color:e.colorTextDisabled},"".concat(t,"-image"),{height:e.emptyImgHeightMD})),(0,a.Z)(n,"&-small",(0,a.Z)({marginBlock:l,color:e.colorTextDisabled},"".concat(t,"-image"),{height:e.emptyImgHeightSM})),n))},p=(0,d.Z)("Empty",(function(e){var n=e.componentCls,t=e.controlHeightLG,a=(0,v.TS)(e,{emptyImgCls:"".concat(n,"-img"),emptyImgHeight:2.5*t,emptyImgHeightMD:t,emptyImgHeightSM:.875*t});return[f(a)]})),g=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)n.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t},x=s.createElement(h,null),j=s.createElement(m,null),E=function(e){var n=e.className,t=e.prefixCls,c=e.image,h=void 0===c?x:c,m=e.description,d=e.children,v=e.imageStyle,f=g(e,["className","prefixCls","image","description","children","imageStyle"]),E=s.useContext(o.E_),S=E.getPrefixCls,b=E.direction,_=S("empty",t),y=p(_),Z=(0,l.Z)(y,2),C=Z[0],w=Z[1];return C(s.createElement(u.Z,{componentName:"Empty"},(function(e){var t,l="undefined"!==typeof m?m:e.description,c="string"===typeof l?l:"empty",o=null;return o="string"===typeof h?s.createElement("img",{alt:c,src:h}):h,s.createElement("div",(0,r.Z)({className:i()(w,_,(t={},(0,a.Z)(t,"".concat(_,"-normal"),h===j),(0,a.Z)(t,"".concat(_,"-rtl"),"rtl"===b),t),n)},f),s.createElement("div",{className:"".concat(_,"-image"),style:v},o),l&&s.createElement("div",{className:"".concat(_,"-description")},l),d&&s.createElement("div",{className:"".concat(_,"-footer")},d))})))};E.PRESENTED_IMAGE_DEFAULT=x,E.PRESENTED_IMAGE_SIMPLE=j;var S=E},9427:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var a=t(67294),r=t(9008),l=t.n(r),c=t(76315),i=t(9991),s=t(8333),o=(t(74916),t(15306),t(8635)),u=t(68863),h=t(39128),m=t(86231),d=t.n(m),v=t(68420),f=t(27344),p=t(44845),g=new(function(){function e(){var n=this;(0,v.Z)(this,e),(0,p.Z)(this,"valueCache",null),(0,p.Z)(this,"listener",null),(0,p.Z)(this,"subscribe",(function(e){n.listener=e})),(0,p.Z)(this,"getState",(function(){return n.valueCache}))}return(0,f.Z)(e,[{key:"setValueCache",value:function(e){var n;this.valueCache={value:e},null===(n=this.listener)||void 0===n||n.call(this)}},{key:"clearValueCache",value:function(){this.valueCache=null}}]),e}()),x=t(85893);var j=function(e){var n=(0,a.useState)(""),t=(0,s.Z)(n,2),r=t[0],l=t[1];return(0,x.jsx)(o.Z,{className:d().mb16,title:"\u8f93\u5165\u6587\u672c",children:(0,x.jsxs)("div",{className:"flex",children:[(0,x.jsx)("div",{className:"grow mr-[6px]",children:(0,x.jsx)(u.Z,{value:r,"aria-label":"\u8f93\u5165\u6587\u672c",onChange:function(e){return l(e.target.value)}})}),(0,x.jsx)("div",{className:"shrink-0",children:(0,x.jsx)(h.Z,{onClick:function(e){r&&!/^\s*$/i.test(r)&&(g.setValueCache({value:r,id:"".concat(Math.random()).replace(/^0./,"")}),l(""))},children:"\u6dfb\u52a0"})})]})})},E=t(41420),S=t(88946),b=t.n(S),_=t(8571),y=t.n(_),Z=t(51904),C=t(32983);var w=function(e){var n=(0,a.useSyncExternalStore)(g.subscribe,g.getState,g.getState),t=(0,a.useState)([]),r=(0,s.Z)(t,2),l=r[0],c=r[1];return(0,a.useMemo)((function(){null!==n&&(c((function(e){var t;return y()(t=[]).call(t,(0,E.Z)(e),[n.value])})),g.clearValueCache())}),[n]),(0,x.jsx)(o.Z,{title:"\u5c55\u793a\u6587\u5b57",children:l.length>0?b()(l).call(l,(function(e,n){return(0,x.jsx)(Z.Z,{className:d().mb8,children:e.value},e.id)})):(0,x.jsx)(C.Z,{})})},N=t(67552),k=t.n(N),I=t(11151);function H(e){var n=k()({pre:"pre",code:"code"},(0,I.ah)(),e.components);return(0,x.jsx)(n.pre,{children:(0,x.jsx)(n.code,{className:"language-javascript",children:"import { Fragment, useState, useMemo, useSyncExternalStore, useId } from 'react';\nimport { createRoot } from 'react-dom/client';\n\nclass Store {\n  valueCache = null;\n  listener = null;\n\n  subscribe = (listener) => {\n    this.listener = listener;\n  };\n\n  getState = () => {\n    return this.valueCache;\n  };\n\n  addValue(value) {\n    this.valueCache = { value };\n    this.listener?.();\n  }\n\n  clearValue() {\n    this.valueCache = null;\n  }\n}\n\nconst store = new Store();\n\nfunction View(props) {\n  const valueCache = useSyncExternalStore(store.subscribe, () => store.getState());\n  const [state, setState] = useState([]);\n\n  useMemo(function() {\n    if (valueCache !== null && valueCache.value) {\n      setState((prevState) => [...prevState, valueCache.value]);\n      store.clearValue();\n    }\n  }, [valueCache]);\n\n  return <div>{ state.join(', ') }</div>;\n}\n\nfunction AddValue(props) {\n  const id = useId();\n\n  function handleClick(event) {\n    const value = document.getElementById(`${ id }-input`).value;\n\n    if (value && value !== '') {\n      store.addValue(value);\n    }\n  }\n\n  return (\n    <Fragment>\n      <input id={ `${ id }-input` } />\n      <button type=\"button\" onClick={ handleClick }>\u70b9\u51fb</button>\n    </Fragment>\n  );\n}\n\nfunction App(props) {\n  return (\n    <div>\n      <AddValue />\n      <View />\n    </div>\n  );\n}\n\nconst root = createRoot(document.getElementById('app'));\n\nroot.render(<App />);\n"})})}var L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=k()({},(0,I.ah)(),e.components),t=n.wrapper;return t?(0,x.jsx)(t,k()({},e,{children:(0,x.jsx)(H,e)})):H(e)},M=c.Z.Title,T=c.Z.Paragraph;var V=function(e){return(0,x.jsxs)(i.Z,{children:[(0,x.jsx)(M,{children:"\u4f7f\u7528useSyncExternalStore\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"}),(0,x.jsx)(T,{children:"\u5728React18\u7684\u7248\u672c\u4e2d\uff0c\u65b0\u6dfb\u52a0\u4e86\u4e00\u4e2aHook API\uff1auseSyncExternalStore\uff0c\u63a8\u8350\u7528\u4e8e\u4ece\u5916\u90e8\u6570\u636e\u6e90\u8bfb\u53d6\u548c\u8ba2\u9605\u7684Hook\u3002"}),(0,x.jsx)(T,{children:"\u901a\u8fc7\u4f7f\u7528useSyncExternalStore\uff0c\u4e5f\u53ef\u4ee5\u7528\u5b83\u5b9e\u73b0\u7ec4\u4ef6\u95f4\u7684\u901a\u4fe1\u3002"}),(0,x.jsx)(L,{}),(0,x.jsx)(M,{level:2,children:"\u4ee3\u7801\u6f14\u793a"}),(0,x.jsx)(T,{children:"\u8fd9\u4e2a\u4f8b\u5b50\u5c55\u793a\u4e86\u5982\u4f55\u5728\u4e00\u4e2a\u7ec4\u4ef6\u5185\u64cd\u4f5c\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u4f20\u9012\u7ed9\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u3002"}),(0,x.jsx)(j,{}),(0,x.jsx)(w,{})]})};function F(e){return(0,x.jsxs)(a.Fragment,{children:[(0,x.jsxs)(l(),{children:[(0,x.jsx)("title",{children:"\u4f7f\u7528useSyncExternalStore\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"}),(0,x.jsx)("meta",{name:"keywords",content:"\u524d\u7aef, js, javascript, react, useSyncExternalStore"}),(0,x.jsx)("meta",{name:"description",content:"\u4f7f\u7528useSyncExternalStore\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"})]}),(0,x.jsx)(V,{})]})}},39748:function(e,n,t){"use strict";var a=t(19623),r=t(73935),l=t(11163),c=t(14137),i=t(39128),s=t(6171),o=t(76467),u=t(97680),h=t.n(u),m=t(85893);n.Z=function(e){var n=(0,l.useRouter)();return[(0,m.jsxs)("div",{className:h().main,children:[e.goBack?(0,m.jsx)("div",{className:"mb-[16px] text-right",children:(0,m.jsxs)(i.Z,{onClick:function(e){n.push("/")},children:[(0,m.jsx)(s.Z,{className:"mr-[6px]"}),"\u8fd4\u56de"]})}):null,null===e||void 0===e?void 0:e.children]},"main"),(0,m.jsx)(o.default,{children:null!==e&&void 0!==e&&e.goToTop&&"object"===("undefined"===typeof document?"undefined":(0,a.Z)(document))?(0,r.createPortal)((0,m.jsx)(c.Z.BackTop,{title:"\u8fd4\u56de\u9876\u90e8",tabIndex:0,role:"button","aria-label":"\u8fd4\u56de\u9876\u90e8",children:(0,m.jsx)("div",{className:h().goToTop,children:"UP"})}),document.body):null},"backTop")]}},32307:function(e,n,t){"use strict";t(74916);var a=t(88946),r=t.n(a),l=t(81290),c=t.n(l),i=t(41664),s=t.n(i),o=t(97183),u=t(46216),h=t(83062),m=t(67337),d=t(56392),v=t.n(d),f=t(2013),p=t(85893),g=[{href:"/",title:"\u6587\u7ae0"},{href:"/favorites",title:"\u6536\u85cf\u5939"},{href:"/project",title:"\u5f00\u6e90\u9879\u76ee"}],x=["github.io","vercel.app"],j=r()(g).call(g,(function(e,n){return(0,p.jsx)("li",{className:v().navListItem,children:(0,p.jsx)(s(),{href:e.href,children:e.title})},e.href)}));n.Z=function(e){return(0,p.jsx)(o.Z.Header,{className:v().antdHeader,children:(0,p.jsxs)("div",{className:v().header,children:[(0,p.jsx)("nav",{className:v().headerLeft,children:(0,p.jsx)("ul",{className:v().navList,children:j})}),(0,p.jsx)("div",{className:v().headerRight,children:(0,p.jsxs)(u.Z,{className:"mt-[-6px]",size:16,children:[(0,p.jsx)(h.Z,{title:"\u5207\u6362\u7f51\u7ad9\u5730\u5740",children:(0,p.jsx)("a",{className:v().switchAddress,role:"button",tabIndex:0,"aria-label":"\u5207\u6362\u7f51\u7ad9\u5730\u5740",onClick:function(e){var n=window.location,t=n.pathname,a=n.hostname,r=/github\.io/.test(a);window.location.href=new(c())(t,"https://duan602728596.".concat(x[r?1:0],"/"))},children:(0,p.jsx)(m.Z,{className:v().switchAddressIcon})})}),(0,p.jsx)("a",{className:v().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,p.jsx)(f.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},2013:function(e,n,t){"use strict";var a=t(85893);n.Z=function(e){var n=e.className,t=e.imageClassName,r=e.avifSrc,l=e.webpSrc,c=e.src,i=e.alt;return(0,a.jsxs)("picture",{className:n,children:[r&&(0,a.jsx)("source",{srcSet:r,type:"image/avif"}),l&&(0,a.jsx)("source",{srcSet:l,type:"image/webp"}),(0,a.jsx)("img",{className:t,src:c,alt:i})]})}},9991:function(e,n,t){"use strict";var a=t(67294),r=t(32307),l=t(39748),c=t(85893);n.Z=function(e){return(0,c.jsxs)(a.Fragment,{children:[(0,c.jsx)(r.Z,{}),(0,c.jsx)(l.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},63655:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/react/useSyncExternalStore-component-communication",function(){return t(9427)}])},97680:function(e){e.exports={main:"main_main__ovwFV",goToTop:"main_goToTop__Soij4"}},56392:function(e){e.exports={antdHeader:"nav_antdHeader__pc6AA",header:"nav_header__K7RoR",headerLeft:"nav_headerLeft__D5kPR",headerRight:"nav_headerRight__plZ1z",navList:"nav_navList__iDQNr",navListItem:"nav_navListItem__UblqT",switchAddress:"nav_switchAddress__vhjXS",githubLink:"nav_githubLink__1sY1n",switchAddressIcon:"nav_switchAddressIcon__e5KfQ"}},86231:function(e){e.exports={mb16:"demo_mb16__qCqwS",mb8:"demo_mb8__8tC_L"}}},function(e){e.O(0,[9128,1091,1327,4011,9827,9398,9774,2888,179],(function(){return n=63655,e(e.s=n);var n}));var n=e.O();_N_E=n}]);