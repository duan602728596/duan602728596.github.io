(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5041],{5467:function(e,n,t){"use strict";function r(e){return Object.keys(e).reduce((n,t)=>((t.startsWith("data-")||t.startsWith("aria-")||"role"===t)&&!t.startsWith("data-__")&&(n[t]=e[t]),n),{})}t.d(n,{Z:function(){return r}})},99138:function(e,n,t){"use strict";t.d(n,{Z:function(){return L}});var r=t(76278),a=t(41322),s=t(84481),i=t(26702),o=t(1558),c=t(94184),l=t.n(c),d=t(82225),u=t(67294),p=t(53124),m=t(5467),h=t(96159),f=t(15671),g=t(43144),v=t(32531),x=t(73568);let b=function(e){(0,v.Z)(t,e);var n=(0,x.Z)(t);function t(){var e;return(0,f.Z)(this,t),e=n.apply(this,arguments),e.state={error:void 0,info:{componentStack:""}},e}return(0,g.Z)(t,[{key:"componentDidCatch",value:function(e,n){this.setState({error:e,info:n})}},{key:"render",value:function(){let{message:e,description:n,children:t}=this.props,{error:r,info:a}=this.state,s=a&&a.componentStack?a.componentStack:null,i=void 0===e?(r||"").toString():e;return r?u.createElement(L,{type:"error",message:i,description:u.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},void 0===n?s:n)}):t}}]),t}(u.Component);var j=t(67968),w=t(45503),_=t(14747);let S=(e,n,t,r,a)=>({backgroundColor:e,border:`${r.lineWidth}px ${r.lineType} ${n}`,[`${a}-icon`]:{color:t}}),N=e=>{let{componentCls:n,motionDurationSlow:t,marginXS:r,marginSM:a,fontSize:s,fontSizeLG:i,lineHeight:o,borderRadiusLG:c,motionEaseInOutCirc:l,alertIconSizeLG:d,colorText:u,paddingContentVerticalSM:p,alertPaddingHorizontal:m,paddingMD:h,paddingContentHorizontalLG:f}=e;return{[n]:Object.assign(Object.assign({},(0,_.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:`${p}px ${m}px`,wordWrap:"break-word",borderRadius:c,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-content`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:s,lineHeight:o},"&-message":{color:u},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${t} ${l}, opacity ${t} ${l},
        padding-top ${t} ${l}, padding-bottom ${t} ${l},
        margin-bottom ${t} ${l}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${n}-with-description`]:{alignItems:"flex-start",paddingInline:f,paddingBlock:h,[`${n}-icon`]:{marginInlineEnd:a,fontSize:d,lineHeight:0},[`${n}-message`]:{display:"block",marginBottom:r,color:u,fontSize:i},[`${n}-description`]:{display:"block"}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},Z=e=>{let{componentCls:n,colorSuccess:t,colorSuccessBorder:r,colorSuccessBg:a,colorWarning:s,colorWarningBorder:i,colorWarningBg:o,colorError:c,colorErrorBorder:l,colorErrorBg:d,colorInfo:u,colorInfoBorder:p,colorInfoBg:m}=e;return{[n]:{"&-success":S(a,r,t,e,n),"&-info":S(m,p,u,e,n),"&-warning":S(o,i,s,e,n),"&-error":Object.assign(Object.assign({},S(d,l,c,e,n)),{[`${n}-description > pre`]:{margin:0,padding:0}})}}},$=e=>{let{componentCls:n,iconCls:t,motionDurationMid:r,marginXS:a,fontSizeIcon:s,colorIcon:i,colorIconHover:o}=e;return{[n]:{"&-action":{marginInlineStart:a},[`${n}-close-icon`]:{marginInlineStart:a,padding:0,overflow:"hidden",fontSize:s,lineHeight:`${s}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${t}-close`]:{color:i,transition:`color ${r}`,"&:hover":{color:o}}},"&-close-text":{color:i,transition:`color ${r}`,"&:hover":{color:o}}}}},y=e=>[N(e),Z(e),$(e)];var k=(0,j.Z)("Alert",e=>{let{fontSizeHeading3:n}=e,t=(0,w.TS)(e,{alertIconSizeLG:n,alertPaddingHorizontal:12});return[y(t)]}),E=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>n.indexOf(r)&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>n.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]]);return t};let C={success:r.Z,info:o.Z,error:a.Z,warning:i.Z},T=e=>{let{icon:n,prefixCls:t,type:r}=e,a=C[r]||null;return n?(0,h.wm)(n,u.createElement("span",{className:`${t}-icon`},n),()=>({className:l()(`${t}-icon`,{[n.props.className]:n.props.className})})):u.createElement(a,{className:`${t}-icon`})},P=e=>{let{isClosable:n,closeText:t,prefixCls:r,closeIcon:a,handleClose:s}=e;return n?u.createElement("button",{type:"button",onClick:s,className:`${r}-close-icon`,tabIndex:0},t?u.createElement("span",{className:`${r}-close-text`},t):a):null},I=e=>{var{description:n,prefixCls:t,message:r,banner:a,className:i,rootClassName:o,style:c,onMouseEnter:h,onMouseLeave:f,onClick:g,afterClose:v,showIcon:x,closable:b,closeText:j,closeIcon:w=u.createElement(s.Z,null),action:_}=e,S=E(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]);let[N,Z]=u.useState(!1),$=u.useRef(),{getPrefixCls:y,direction:C}=u.useContext(p.E_),I=y("alert",t),[L,z]=k(I),O=e=>{var n;Z(!0),null===(n=S.onClose)||void 0===n||n.call(S,e)},R=!!j||b,W=(()=>{let{type:e}=S;return void 0!==e?e:a?"warning":"info"})(),A=!!a&&void 0===x||x,B=l()(I,`${I}-${W}`,{[`${I}-with-description`]:!!n,[`${I}-no-icon`]:!A,[`${I}-banner`]:!!a,[`${I}-rtl`]:"rtl"===C},i,o,z),H=(0,m.Z)(S);return L(u.createElement(d.ZP,{visible:!N,motionName:`${I}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:v},e=>{let{className:t,style:a}=e;return u.createElement("div",Object.assign({ref:$,"data-show":!N,className:l()(B,t),style:Object.assign(Object.assign({},c),a),onMouseEnter:h,onMouseLeave:f,onClick:g,role:"alert"},H),A?u.createElement(T,{description:n,icon:S.icon,prefixCls:I,type:W}):null,u.createElement("div",{className:`${I}-content`},r?u.createElement("div",{className:`${I}-message`},r):null,n?u.createElement("div",{className:`${I}-description`},n):null),_?u.createElement("div",{className:`${I}-action`},_):null,u.createElement(P,{isClosable:!!R,closeText:j,prefixCls:I,closeIcon:w,handleClose:O}))}))};I.ErrorBoundary=b;var L=I},76278:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(1413),a=t(67294),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},i=t(93771),o=function(e,n){return a.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:s}))};o.displayName="CheckCircleFilled";var c=a.forwardRef(o)},26702:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(1413),a=t(67294),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},i=t(93771),o=function(e,n){return a.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:s}))};o.displayName="ExclamationCircleFilled";var c=a.forwardRef(o)},1558:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(1413),a=t(67294),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},i=t(93771),o=function(e,n){return a.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:s}))};o.displayName="InfoCircleFilled";var c=a.forwardRef(o)},87903:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return w}});var r=t(67294),a=t(9008),s=t.n(a),i=t(48726),o=t(99138),c=t(22410),l=t(67552),d=t.n(l),u=t(85893),p=t(11151);function m(e){var n=d()({pre:"pre",code:"code"},(0,p.ah)(),e.components);return(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-typescript",children:"interface WrapPromise<T> {\n  read(): T | undefined;\n}\n\nenum WrapStatus {\n  Pending = 'pending',\n  Success = 'success',\n  Error = 'error'\n}\n\n/**\n * 加载器\n * @param { () => Promise<T> } promise: 一个返回Promise的函数\n */\nfunction wrapPromise<T = unknown>(promise: () => Promise<T>): WrapPromise<T> {\n  let status: WrapStatus = WrapStatus.Pending;\n  let result: T | Error;\n  let suspender: Promise<void>;\n\n  // 第一次读取read时运行promise\n  function runPromise(): void {\n    suspender ??= promise().then<void, void>(\n      (value: T): void => {\n        status = WrapStatus.Success;\n        result = value;\n      },\n      (err: Error): void => {\n        status = WrapStatus.Error;\n        result = err;\n      }\n    );\n  }\n\n  return {\n    read(): T | undefined {\n      runPromise();\n\n      if (status === WrapStatus.Pending) {\n        throw suspender;\n      } else if (status === WrapStatus.Error) {\n        throw result;\n      } else if (status === WrapStatus.Success) {\n        return result as T;\n      }\n    }\n  };\n}\n"})})}var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=d()({},(0,p.ah)(),e.components).wrapper;return n?(0,u.jsx)(n,d()({},e,{children:(0,u.jsx)(m,e)})):m(e)};function f(e){var n=d()({pre:"pre",code:"code"},(0,p.ah)(),e.components);return(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-javascript",children:"import { Suspense } from 'react';\n\nconst g = wrapPromise(getData);\n\nfunction Child(props) {\n  const data = g.read();\n\n  return <div>{ data }</div>;\n}\n\nfunction Demo(props) {\n  return (\n    <Suspense fallback=\"Loading...\">\n      <Child />\n    </Suspense>\n  );\n}\n"})})}var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=d()({},(0,p.ah)(),e.components).wrapper;return n?(0,u.jsx)(n,d()({},e,{children:(0,u.jsx)(f,e)})):f(e)},v=i.Z.Title,x=i.Z.Paragraph,b=i.Z.Text,j=function(e){return(0,u.jsxs)(c.Z,{children:[(0,u.jsx)(v,{children:"在React18中，配合Suspense来获取数据"}),(0,u.jsxs)(x,{children:["在React18的版本中，",(0,u.jsx)(b,{code:!0,children:"<Suspense>"}),"组件可以用于数据获取。"]}),(0,u.jsx)(x,{children:"首先，要实现一个数据的加载器："}),(0,u.jsx)(h,{}),(0,u.jsx)(x,{children:"然后在组件内调用："}),(0,u.jsx)(g,{}),(0,u.jsx)(o.Z,{type:"info",message:[(0,u.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,u.jsxs)("div",{className:"py-[8px]",children:["React使用Suspense来获取数据的Demo：",(0,u.jsx)("a",{href:"https://codesandbox.io/s/frosty-hermann-bztrp?file=/src/fakeApi.js",target:"_blank",rel:"noopener noreferrer",children:"https://codesandbox.io/s/frosty-hermann-bztrp?file=/src/fakeApi.js"})]},"react-gradual-upgrade-demo"),(0,u.jsxs)("div",{className:"py-[8px]",children:["React Suspense for Data Fetching官方文档：",(0,u.jsx)("a",{href:"https://reactjs.org/docs/concurrent-mode-suspense.html",target:"_blank",rel:"noopener noreferrer",children:"https://reactjs.org/docs/concurrent-mode-suspense.html"})]},"webpack-module-federation")]})]})};function w(e){return(0,u.jsxs)(r.Fragment,{children:[(0,u.jsxs)(s(),{children:[(0,u.jsx)("title",{children:"React18配合Suspense获取数据"}),(0,u.jsx)("meta",{name:"keywords",content:"前端, js, javascript, react"}),(0,u.jsx)("meta",{name:"description",content:"在react18中，配合Suspense来获取数据"})]}),(0,u.jsx)(j,{})]})}},54892:function(e,n,t){"use strict";var r=t(19623),a=t(73935),s=t(11163),i=t(51341),o=t(18662),c=t(75162),l=t(37653),d=t(76467),u=t(3744),p=t.n(u),m=t(85893),h=i.Z.BackTop;n.Z=function(e){var n=(0,s.useRouter)();return[(0,m.jsxs)("div",{className:p().main,children:[e.goBack?(0,m.jsx)("div",{className:"mb-[16px] text-right",children:(0,m.jsxs)(o.ZP,{onClick:function(e){n.push("/")},children:[(0,m.jsx)(l.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,m.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,r.Z)(document))==="object"?(0,a.createPortal)((0,m.jsx)(h,{type:"primary",icon:(0,m.jsx)(c.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},34341:function(e,n,t){"use strict";t(74916);var r=t(88946),a=t.n(r),s=t(81290),i=t.n(s),o=t(41664),c=t.n(o),l=t(97183),d=t(26713),u=t(83062),p=t(67337),m=t(62139),h=t.n(m),f=t(30654),g=t(85893),v=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],x=["github.io","vercel.app"],b=a()(v).call(v,function(e,n){return(0,g.jsx)("li",{className:h().navListItem,children:(0,g.jsx)(c(),{href:e.href,children:e.title})},e.href)});n.Z=function(e){return(0,g.jsx)(l.Z.Header,{className:h().antdHeader,children:(0,g.jsxs)("div",{className:h().header,children:[(0,g.jsx)("nav",{className:h().headerLeft,children:(0,g.jsx)("ul",{className:h().navList,children:b})}),(0,g.jsx)("div",{className:h().headerRight,children:(0,g.jsxs)(d.Z,{size:16,children:[(0,g.jsx)(u.Z,{title:"切换网站地址",children:(0,g.jsx)("a",{className:h().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var n=window.location,t=n.pathname,r=n.hostname,a=/github\.io/.test(r);window.location.href=new(i())(t,"https://duan602728596.".concat(x[a?1:0],"/"))},children:(0,g.jsx)(p.Z,{className:h().switchAddressIcon})})}),(0,g.jsx)("a",{className:h().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,g.jsx)(f.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},30654:function(e,n,t){"use strict";var r=t(85893);n.Z=function(e){var n=e.className,t=e.imageClassName,a=e.avifSrc,s=e.webpSrc,i=e.src,o=e.alt;return(0,r.jsxs)("picture",{className:n,children:[a&&(0,r.jsx)("source",{srcSet:a,type:"image/avif"}),s&&(0,r.jsx)("source",{srcSet:s,type:"image/webp"}),(0,r.jsx)("img",{className:t,src:i,alt:o})]})}},22410:function(e,n,t){"use strict";var r=t(67294),a=t(34341),s=t(54892),i=t(85893);n.Z=function(e){return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)(a.Z,{}),(0,i.jsx)(s.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},8912:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/react/react18-get-data-with-suspense",function(){return t(87903)}])},3744:function(e){e.exports={main:"main_main__ovwFV",goToTop:"main_goToTop__Soij4"}},62139:function(e){e.exports={antdHeader:"nav_antdHeader__pc6AA",header:"nav_header__K7RoR",headerLeft:"nav_headerLeft__D5kPR",headerRight:"nav_headerRight__plZ1z",navList:"nav_navList__iDQNr",navListItem:"nav_navListItem__UblqT",switchAddress:"nav_switchAddress__vhjXS",githubLink:"nav_githubLink__1sY1n",switchAddressIcon:"nav_switchAddressIcon__e5KfQ"}}},function(e){e.O(0,[5876,4796,9425,9774,2888,179],function(){return e(e.s=8912)}),_N_E=e.O()}]);