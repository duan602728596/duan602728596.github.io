(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5312],{5467:function(e,n,t){"use strict";function r(e){return Object.keys(e).reduce((n,t)=>((t.startsWith("data-")||t.startsWith("aria-")||"role"===t)&&!t.startsWith("data-__")&&(n[t]=e[t]),n),{})}t.d(n,{Z:function(){return r}})},99138:function(e,n,t){"use strict";t.d(n,{Z:function(){return O}});var r=t(76278),o=t(41322),a=t(84481),c=t(26702),i=t(1558),s=t(94184),l=t.n(s),d=t(62874),u=t(67294),p=t(53124),m=t(5467),f=t(96159),h=t(15671),g=t(43144),v=t(32531),x=t(73568);let j=function(e){(0,v.Z)(t,e);var n=(0,x.Z)(t);function t(){var e;return(0,h.Z)(this,t),e=n.apply(this,arguments),e.state={error:void 0,info:{componentStack:""}},e}return(0,g.Z)(t,[{key:"componentDidCatch",value:function(e,n){this.setState({error:e,info:n})}},{key:"render",value:function(){let{message:e,description:n,children:t}=this.props,{error:r,info:o}=this.state,a=o&&o.componentStack?o.componentStack:null,c=void 0===e?(r||"").toString():e;return r?u.createElement(O,{type:"error",message:c,description:u.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},void 0===n?a:n)}):t}}]),t}(u.Component);var b=t(67968),y=t(45503),w=t(14747);let _=(e,n,t,r,o)=>({backgroundColor:e,border:`${r.lineWidth}px ${r.lineType} ${n}`,[`${o}-icon`]:{color:t}}),C=e=>{let{componentCls:n,motionDurationSlow:t,marginXS:r,marginSM:o,fontSize:a,fontSizeLG:c,lineHeight:i,borderRadiusLG:s,motionEaseInOutCirc:l,alertIconSizeLG:d,colorText:u,paddingContentVerticalSM:p,alertPaddingHorizontal:m,paddingMD:f,paddingContentHorizontalLG:h}=e;return{[n]:Object.assign(Object.assign({},(0,w.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:`${p}px ${m}px`,wordWrap:"break-word",borderRadius:s,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-content`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:a,lineHeight:i},"&-message":{color:u},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${t} ${l}, opacity ${t} ${l},
        padding-top ${t} ${l}, padding-bottom ${t} ${l},
        margin-bottom ${t} ${l}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${n}-with-description`]:{alignItems:"flex-start",paddingInline:h,paddingBlock:f,[`${n}-icon`]:{marginInlineEnd:o,fontSize:d,lineHeight:0},[`${n}-message`]:{display:"block",marginBottom:r,color:u,fontSize:c},[`${n}-description`]:{display:"block"}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},N=e=>{let{componentCls:n,colorSuccess:t,colorSuccessBorder:r,colorSuccessBg:o,colorWarning:a,colorWarningBorder:c,colorWarningBg:i,colorError:s,colorErrorBorder:l,colorErrorBg:d,colorInfo:u,colorInfoBorder:p,colorInfoBg:m}=e;return{[n]:{"&-success":_(o,r,t,e,n),"&-info":_(m,p,u,e,n),"&-warning":_(i,c,a,e,n),"&-error":Object.assign(Object.assign({},_(d,l,s,e,n)),{[`${n}-description > pre`]:{margin:0,padding:0}})}}},R=e=>{let{componentCls:n,iconCls:t,motionDurationMid:r,marginXS:o,fontSizeIcon:a,colorIcon:c,colorIconHover:i}=e;return{[n]:{"&-action":{marginInlineStart:o},[`${n}-close-icon`]:{marginInlineStart:o,padding:0,overflow:"hidden",fontSize:a,lineHeight:`${a}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${t}-close`]:{color:c,transition:`color ${r}`,"&:hover":{color:i}}},"&-close-text":{color:c,transition:`color ${r}`,"&:hover":{color:i}}}}},Z=e=>[C(e),N(e),R(e)];var $=(0,b.Z)("Alert",e=>{let{fontSizeHeading3:n}=e,t=(0,y.TS)(e,{alertIconSizeLG:n,alertPaddingHorizontal:12});return[Z(t)]}),k=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>n.indexOf(r)&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>n.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]]);return t};let E={success:r.Z,info:i.Z,error:o.Z,warning:c.Z},L=e=>{let{icon:n,prefixCls:t,type:r}=e,o=E[r]||null;return n?(0,f.wm)(n,u.createElement("span",{className:`${t}-icon`},n),()=>({className:l()(`${t}-icon`,{[n.props.className]:n.props.className})})):u.createElement(o,{className:`${t}-icon`})},S=e=>{let{isClosable:n,closeText:t,prefixCls:r,closeIcon:o,handleClose:a}=e;return n?u.createElement("button",{type:"button",onClick:a,className:`${r}-close-icon`,tabIndex:0},t?u.createElement("span",{className:`${r}-close-text`},t):o):null},T=e=>{var{description:n,prefixCls:t,message:r,banner:o,className:c,rootClassName:i,style:s,onMouseEnter:f,onMouseLeave:h,onClick:g,afterClose:v,showIcon:x,closable:j,closeText:b,closeIcon:y=u.createElement(a.Z,null),action:w}=e,_=k(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]);let[C,N]=u.useState(!1),R=u.useRef(),{getPrefixCls:Z,direction:E}=u.useContext(p.E_),T=Z("alert",t),[O,I]=$(T),P=e=>{var n;N(!0),null===(n=_.onClose)||void 0===n||n.call(_,e)},z=!!b||j,M=(()=>{let{type:e}=_;return void 0!==e?e:o?"warning":"info"})(),H=!!o&&void 0===x||x,A=l()(T,`${T}-${M}`,{[`${T}-with-description`]:!!n,[`${T}-no-icon`]:!H,[`${T}-banner`]:!!o,[`${T}-rtl`]:"rtl"===E},c,i,I),B=(0,m.Z)(_);return O(u.createElement(d.Z,{visible:!C,motionName:`${T}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:v},e=>{let{className:t,style:o}=e;return u.createElement("div",Object.assign({ref:R,"data-show":!C,className:l()(A,t),style:Object.assign(Object.assign({},s),o),onMouseEnter:f,onMouseLeave:h,onClick:g,role:"alert"},B),H?u.createElement(L,{description:n,icon:_.icon,prefixCls:T,type:M}):null,u.createElement("div",{className:`${T}-content`},r?u.createElement("div",{className:`${T}-message`},r):null,n?u.createElement("div",{className:`${T}-description`},n):null),w?u.createElement("div",{className:`${T}-action`},w):null,u.createElement(S,{isClosable:!!z,closeText:b,prefixCls:T,closeIcon:y,handleClose:P}))}))};T.ErrorBoundary=j;var O=T},76278:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(1413),o=t(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},c=t(93771),i=function(e,n){return o.createElement(c.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:a}))};i.displayName="CheckCircleFilled";var s=o.forwardRef(i)},26702:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(1413),o=t(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},c=t(93771),i=function(e,n){return o.createElement(c.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:a}))};i.displayName="ExclamationCircleFilled";var s=o.forwardRef(i)},1558:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(1413),o=t(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},c=t(93771),i=function(e,n){return o.createElement(c.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:a}))};i.displayName="InfoCircleFilled";var s=o.forwardRef(i)},84254:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var r=t(67294),o=t(9008),a=t.n(o),c=t(48726),i=t(99138),s=t(34065),l=t(7244),d=t(67552),u=t.n(d),p=t(85893),m=t(11151);function f(e){var n=u()({pre:"pre",code:"code"},(0,m.ah)(),e.components);return(0,p.jsx)(n.pre,{children:(0,p.jsx)(n.code,{className:"language-typescript",children:"import type { FunctionComponent, ComponentClass } from 'react';\nimport { render, unmountComponentAtNode } from 'react-dom';\n\ninterface CreateLegacyRoot {\n  render(props: any): void;\n  unmount(): void;\n}\n\ntype LegacyReturn = (container: HTMLElement) => CreateLegacyRoot;\n\n/**\n * 创建一个createLegacyRoot函数，保证组件能够兼容多个react版本\n * @param { FunctionComponent | ComponentClass } Component: 组件\n */\nfunction legacy(Component: FunctionComponent | ComponentClass): LegacyReturn {\n  return function createLegacyRoot(container: HTMLElement): CreateLegacyRoot {\n    return {\n      render(props: any): void {\n        render(<Component { ...props } />, container);\n      },\n      unmount(): void {\n        unmountComponentAtNode(container);\n      }\n    };\n  };\n}\n\nexport default legacy;\n"})})}var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,m.ah)(),e.components).wrapper;return n?(0,p.jsx)(n,u()({},e,{children:(0,p.jsx)(f,e)})):f(e)};function g(e){var n=u()({pre:"pre",code:"code"},(0,m.ah)(),e.components);return(0,p.jsx)(n.pre,{children:(0,p.jsx)(n.code,{className:"language-javascript",children:"import { useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * 加载联邦模块\n * @param { Function } props.loader: 加载的联邦模块\n * @param { object } props.moduleProps\n */\nfunction Loader(props) {\n  const { loader, moduleProps } = props;\n  const containerRef = useRef(), // dom，ReactDOM.render渲染的节点\n    rootRef = useRef(); // 保存root对象\n\n  // 加载并渲染模块\n  async function loadModule() {\n    const { createLegacyRoot } = await loader();\n\n    rootRef.current = createLegacyRoot(containerRef.current);\n    rootRef.current.render(moduleProps);\n  }\n\n  useEffect(function() {\n    loadModule();\n\n    return function() {\n      rootRef.current.unmount();\n    };\n  }, [loader, moduleProps]);\n\n  return <div ref={ containerRef } />;\n}\n\nLoader.propTypes = {\n  loader: PropTypes.func,\n  moduleProps: PropTypes.object\n};\n\nexport default Loader;\n"})})}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,m.ah)(),e.components).wrapper;return n?(0,p.jsx)(n,u()({},e,{children:(0,p.jsx)(g,e)})):g(e)};function x(e){var n=u()({pre:"pre",code:"code"},(0,m.ah)(),e.components);return(0,p.jsx)(n.pre,{children:(0,p.jsx)(n.code,{className:"language-javascript",children:"function App(props) {\n  function handleClick(event) {\n    alert('你点击了按钮。');\n  }\n\n  return (\n    <div>\n      <Loader loader={ () => import('project/module') }\n        moduleProps={{ onClick: handleClick }}\n      />\n    </div>\n  );\n}\n"})})}var j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,m.ah)(),e.components).wrapper;return n?(0,p.jsx)(n,u()({},e,{children:(0,p.jsx)(x,e)})):x(e)},b=c.Z.Title,y=c.Z.Paragraph,w=c.Z.Text,_=function(e){return(0,p.jsxs)(s.Z,{children:[(0,p.jsx)(b,{children:"如何使用多版本的React"}),(0,p.jsxs)(y,{children:["在开发过程中使用联邦模块功能，使用其他项目的React组件，会出现\xa0",(0,p.jsx)(w,{type:"danger",children:"Minified React error #321;"}),"\xa0错误。这是由于多个版本的React导致的。"]}),(0,p.jsxs)(y,{children:[(0,p.jsx)("a",{href:"https://reactjs.org/blog/2020/08/10/react-v17-rc.html#changes-to-event-delegation",target:"_blank",rel:"noopener noreferrer",children:"在React@17中，事件系统进行了更改。"}),"这可以让我们使用React的多版本，解决多个版本的React导致的错误。"]}),(0,p.jsx)(b,{level:2,children:"导出组件出口"}),(0,p.jsx)(y,{children:"我们创建一个函数，来包裹我们需要导出的组件出口。"}),(0,p.jsx)(h,{}),(0,p.jsx)(y,{children:"然后导出一个方法，供其他位置调用。"}),(0,p.jsx)(l.Z,{type:"javascript",children:"export const createLegacyRoot = legacy(Component);"}),(0,p.jsx)(b,{level:2,children:"在其他项目调用方法"}),(0,p.jsx)(y,{children:"我们创建一个Loader函数，来加载导出的方法。"}),(0,p.jsx)(v,{}),(0,p.jsx)(y,{children:"然后加载组件并调用。"}),(0,p.jsx)(j,{}),(0,p.jsx)(i.Z,{type:"info",message:[(0,p.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,p.jsxs)("div",{className:"py-[8px]",children:["React多版本的Demo：",(0,p.jsx)("a",{href:"src/pages/article/react/MultipleVersionsOfReact/MultipleVersionsOfReact",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/reactjs/react-gradual-upgrade-demo/"})]},"react-gradual-upgrade-demo"),(0,p.jsxs)("div",{className:"py-[8px]",children:["webpack联邦模块官方文档：",(0,p.jsx)("a",{href:"src/pages/article/react/MultipleVersionsOfReact/MultipleVersionsOfReact",target:"_blank",rel:"noopener noreferrer",children:"https://webpack.js.org/concepts/module-federation/"})]},"webpack-module-federation")]})]})};function C(e){return(0,p.jsxs)(r.Fragment,{children:[(0,p.jsxs)(a(),{children:[(0,p.jsx)("title",{children:"如何使用多版本的React"}),(0,p.jsx)("meta",{name:"keywords",content:"前端, React, module-federation, 模块联邦"}),(0,p.jsx)("meta",{name:"description",content:"如何使用多版本的React"})]}),(0,p.jsx)(_,{})]})}},38914:function(e,n,t){"use strict";var r=t(19623),o=t(73935),a=t(11163),c=t(1472),i=t(18662),s=t(75162),l=t(37653),d=t(76467),u=t(35919),p=t.n(u),m=t(85893),f=c.Z.BackTop;n.Z=function(e){var n=(0,a.useRouter)();return[(0,m.jsxs)("div",{className:p().main,children:[e.goBack?(0,m.jsx)("div",{className:"mb-[16px] text-right",children:(0,m.jsxs)(i.ZP,{onClick:function(e){n.push("/")},children:[(0,m.jsx)(l.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,m.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,r.Z)(document))==="object"?(0,o.createPortal)((0,m.jsx)(f,{type:"primary",icon:(0,m.jsx)(s.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},43699:function(e,n,t){"use strict";t(74916);var r=t(88946),o=t.n(r),a=t(81290),c=t.n(a),i=t(41664),s=t.n(i),l=t(97183),d=t(26713),u=t(83062),p=t(67337),m=t(48739),f=t.n(m),h=t(90010),g=t(85893),v=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],x=["github.io","vercel.app"],j=o()(v).call(v,function(e,n){return(0,g.jsx)("li",{className:f().navListItem,children:(0,g.jsx)(s(),{href:e.href,children:e.title})},e.href)});n.Z=function(e){return(0,g.jsx)(l.Z.Header,{className:f().antdHeader,children:(0,g.jsxs)("div",{className:f().header,children:[(0,g.jsx)("nav",{className:f().headerLeft,children:(0,g.jsx)("ul",{className:f().navList,children:j})}),(0,g.jsx)("div",{className:f().headerRight,children:(0,g.jsxs)(d.Z,{size:16,children:[(0,g.jsx)(u.Z,{title:"切换网站地址",children:(0,g.jsx)("a",{className:f().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var n=window.location,t=n.pathname,r=n.hostname,o=/github\.io/.test(r);window.location.href=new(c())(t,"https://duan602728596.".concat(x[o?1:0],"/"))},children:(0,g.jsx)(p.Z,{className:f().switchAddressIcon})})}),(0,g.jsx)("a",{className:f().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,g.jsx)(h.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},90010:function(e,n,t){"use strict";var r=t(85893);n.Z=function(e){var n=e.className,t=e.imageClassName,o=e.avifSrc,a=e.webpSrc,c=e.src,i=e.alt;return(0,r.jsxs)("picture",{className:n,children:[o&&(0,r.jsx)("source",{srcSet:o,type:"image/avif"}),a&&(0,r.jsx)("source",{srcSet:a,type:"image/webp"}),(0,r.jsx)("img",{className:t,src:c,alt:i})]})}},34065:function(e,n,t){"use strict";var r=t(67294),o=t(43699),a=t(38914),c=t(85893);n.Z=function(e){return(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)(o.Z,{}),(0,c.jsx)(a.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},32230:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/react/multiple-versions-of-react",function(){return t(84254)}])},35919:function(e){e.exports={main:"main_main__ovwFV",goToTop:"main_goToTop__Soij4"}},48739:function(e){e.exports={antdHeader:"nav_antdHeader__pc6AA",header:"nav_header__K7RoR",headerLeft:"nav_headerLeft__D5kPR",headerRight:"nav_headerRight__plZ1z",navList:"nav_navList__iDQNr",navListItem:"nav_navListItem__UblqT",switchAddress:"nav_switchAddress__vhjXS",githubLink:"nav_githubLink__1sY1n",switchAddressIcon:"nav_switchAddressIcon__e5KfQ"}}},function(e){e.O(0,[5876,4796,4940,9774,2888,179],function(){return e(e.s=32230)}),_N_E=e.O()}]);