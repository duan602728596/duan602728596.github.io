(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8196],{79977:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(67294),o=r(84481),a=r(94184),l=r.n(a),i=r(98787),s=r(45353),c=r(53124),d=r(14747),u=r(45503),p=r(67968);let genBaseStyle=e=>{let{paddingXXS:t,lineWidth:r,tagPaddingHorizontal:n,componentCls:o}=e,a=n-r;return{[o]:Object.assign(Object.assign({},(0,d.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:a,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${o}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${o}-close-icon`]:{marginInlineStart:t-r,color:e.colorTextDescription,fontSize:e.tagIconSize,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${o}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${o}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:a}}),[`${o}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},prepareToken=e=>{let{lineWidth:t,fontSizeIcon:r}=e,n=e.fontSizeSM,o=`${e.lineHeightSM*n}px`,a=(0,u.TS)(e,{tagFontSize:n,tagLineHeight:o,tagIconSize:r-2*t,tagPaddingHorizontal:8,tagBorderlessBg:e.colorFillTertiary});return a},prepareCommonToken=e=>({defaultBg:e.colorFillQuaternary,defaultColor:e.colorText});var h=(0,p.Z)("Tag",e=>{let t=prepareToken(e);return genBaseStyle(t)},prepareCommonToken),__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)0>t.indexOf(n[o])&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};let g=n.forwardRef((e,t)=>{let{prefixCls:r,style:o,className:a,checked:i,onChange:s,onClick:d}=e,u=__rest(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:p,tag:g}=n.useContext(c.E_),m=p("tag",r),[f,b]=h(m),x=l()(m,`${m}-checkable`,{[`${m}-checkable-checked`]:i},null==g?void 0:g.className,a,b);return f(n.createElement("span",Object.assign({},u,{ref:t,style:Object.assign(Object.assign({},o),null==g?void 0:g.style),className:x,onClick:e=>{null==s||s(!i),null==d||d(e)}})))});var m=r(98719);let genPresetStyle=e=>(0,m.Z)(e,(t,r)=>{let{textColor:n,lightBorderColor:o,lightColor:a,darkColor:l}=r;return{[`${e.componentCls}-${t}`]:{color:n,background:a,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:l,borderColor:l},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}});var f=(0,p.b)(["Tag","preset"],e=>{let t=prepareToken(e);return genPresetStyle(t)},prepareCommonToken);let genTagStatusStyle=(e,t,r)=>{let n=function(e){if("string"!=typeof e)return e;let t=e.charAt(0).toUpperCase()+e.slice(1);return t}(r);return{[`${e.componentCls}-${t}`]:{color:e[`color${r}`],background:e[`color${n}Bg`],borderColor:e[`color${n}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var b=(0,p.b)(["Tag","status"],e=>{let t=prepareToken(e);return[genTagStatusStyle(t,"success","Success"),genTagStatusStyle(t,"processing","Info"),genTagStatusStyle(t,"error","Error"),genTagStatusStyle(t,"warning","Warning")]},prepareCommonToken),tag_rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)0>t.indexOf(n[o])&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};let x=n.forwardRef((e,t)=>{let{prefixCls:r,className:a,rootClassName:d,style:u,children:p,icon:g,color:m,onClose:x,closeIcon:v,closable:y,bordered:j=!0}=e,_=tag_rest(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:C,direction:k,tag:S}=n.useContext(c.E_),[T,w]=n.useState(!0);n.useEffect(()=>{"visible"in _&&w(_.visible)},[_.visible]);let N=(0,i.o2)(m),$=(0,i.yT)(m),O=N||$,Z=Object.assign(Object.assign({backgroundColor:m&&!O?m:void 0},null==S?void 0:S.style),u),P=C("tag",r),[F,E]=h(P),L=l()(P,null==S?void 0:S.className,{[`${P}-${m}`]:O,[`${P}-has-color`]:m&&!O,[`${P}-hidden`]:!T,[`${P}-rtl`]:"rtl"===k,[`${P}-borderless`]:!j},a,d,E),handleCloseClick=e=>{e.stopPropagation(),null==x||x(e),e.defaultPrevented||w(!1)},[,I]=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.createElement(o.Z,null),l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i="boolean"==typeof e?e:void 0===t?!!l:!1!==t&&null!==t;if(!i)return[!1,null];let s="boolean"==typeof t||null==t?a:t;return[!0,r?r(s):s]}(y,v,e=>null===e?n.createElement(o.Z,{className:`${P}-close-icon`,onClick:handleCloseClick}):n.createElement("span",{className:`${P}-close-icon`,onClick:handleCloseClick},e),null,!1),B="function"==typeof _.onClick||p&&"a"===p.type,D=g||null,z=D?n.createElement(n.Fragment,null,D,p&&n.createElement("span",null,p)):p,A=n.createElement("span",Object.assign({},_,{ref:t,className:L,style:Z}),z,I,N&&n.createElement(f,{key:"preset",prefixCls:P}),$&&n.createElement(b,{key:"status",prefixCls:P}));return F(B?n.createElement(s.Z,{component:"Tag"},A):A)});x.CheckableTag=g;var v=x},66022:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return DioUploadFilePage}});var n=r(67294),o=r(9008),a=r.n(o),l=r(48726),i=r(79977),s=r(77703),c=r.n(s),d=r(86471),u=r(67552),p=r.n(u),h=r(85893),g=r(11151);function _createMdxContent(e){var t=p()({pre:"pre",code:"code"},(0,g.ah)(),e.components);return(0,h.jsx)(t.pre,{children:(0,h.jsx)(t.code,{className:"language-dart",children:"import 'dart:io';\nimport 'dart:typed_data';\nimport 'package:dio/dio.dart';\n\nFuture<Response<dynamic>> requestUploadFile(filePath) async {\n  Dio dio = Dio();\n  File file = File(filePath);\n  Uint8List bytes = await file.readAsBytes();\n  Stream<List<int>> stream = MultipartFile.fromBytes(bytes).finalize();\n\n  Response<dynamic> response = await dio.put(\n    'https://xxxxxx.com/upload',\n    data: stream,\n    options: Options(\n      contentType: mimeType,\n      headers: {\n        'content-length': (await file.length()).toString()\n      }\n    )\n  );\n\n  return response;\n}\n"})})}var uploadFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=p()({},(0,g.ah)(),e.components).wrapper;return t?(0,h.jsx)(t,p()({},e,{children:(0,h.jsx)(_createMdxContent,e)})):_createMdxContent(e)},m=l.Z.Title,f=l.Z.Paragraph,DioUploadFile_DioUploadFile=function(){return(0,h.jsxs)(d.Z,{children:[(0,h.jsx)(m,{children:"使用dio上传文件"}),(0,h.jsxs)(f,{children:["在Flutter开发中，使用",(0,h.jsx)("a",{href:"https://github.com/flutterchina/dio",target:"_blank",rel:"noopener noreferrer",children:"dio"}),"实现上传文件的功能："]}),(0,h.jsx)(uploadFile,{}),(0,h.jsxs)(f,{children:["由于dio会将请求转换成",(0,h.jsx)(i.Z,{className:c().tag,children:"String"}),"类型，所以需要将",(0,h.jsx)(i.Z,{className:c().tag,children:"Uint8List"}),"类型转换成",(0,h.jsx)(i.Z,{className:c().tag,children:"Stream<List<int>>"}),"类型。具体请参考dio的",(0,h.jsx)("a",{href:"https://github.com/flutterchina/dio/issues/485#issuecomment-552845924",target:"_blank",rel:"noopener noreferrer",children:"issues"}),"，这块算是一个小坑吧。"]})]})};function DioUploadFilePage(e){return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsxs)(a(),{children:[(0,h.jsx)("title",{children:"使用dio上传文件"}),(0,h.jsx)("meta",{name:"keywords",content:"前端, Flutter, Dart, dio"}),(0,h.jsx)("meta",{name:"description",content:"使用dio上传文件"})]}),(0,h.jsx)(DioUploadFile_DioUploadFile,{})]})}},51775:function(e,t,r){"use strict";var n=r(19623),o=r(73935),a=r(11163),l=r(35846),i=r(18610),s=r(75162),c=r(37653),d=r(76467),u=r(96865),p=r.n(u),h=r(85893),g=l.Z.BackTop;t.Z=function(e){var t=(0,a.useRouter)();return[(0,h.jsxs)("div",{className:p().main,children:[e.goBack?(0,h.jsx)("div",{className:"mb-[16px] text-right",children:(0,h.jsxs)(i.ZP,{onClick:function(e){t.push("/")},children:[(0,h.jsx)(c.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,h.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,n.Z)(document))==="object"?(0,o.createPortal)((0,h.jsx)(g,{type:"primary",icon:(0,h.jsx)(s.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},5189:function(e,t,r){"use strict";r(64043);var n=r(88946),o=r.n(n),a=r(81290),l=r.n(a),i=r(41664),s=r.n(i),c=r(21612),d=r(78957),u=r(83062),p=r(67337),h=r(10534),g=r.n(h),m=r(43989),f=r(85893),b=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],x=["github.io","vercel.app"],v=o()(b).call(b,function(e,t){return(0,f.jsx)("li",{className:g().navListItem,children:(0,f.jsx)(s(),{href:e.href,children:e.title})},e.href)});t.Z=function(e){return(0,f.jsx)(c.Z.Header,{className:g().antdHeader,children:(0,f.jsxs)("div",{className:g().header,children:[(0,f.jsx)("nav",{className:g().headerLeft,children:(0,f.jsx)("ul",{className:g().navList,children:v})}),(0,f.jsx)("div",{className:g().headerRight,children:(0,f.jsxs)(d.Z,{size:16,children:[(0,f.jsx)(u.Z,{title:"切换网站地址",children:(0,f.jsx)("a",{className:g().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var t=window.location,r=t.pathname,n=t.hostname,o=/github\.io/.test(n);window.location.href=new(l())(r,"https://duan602728596.".concat(x[o?1:0],"/"))},children:(0,f.jsx)(p.Z,{className:g().switchAddressIcon})})}),(0,f.jsx)("a",{className:g().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,f.jsx)(m.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},43989:function(e,t,r){"use strict";var n=r(85893);t.Z=function(e){var t=e.className,r=e.imageClassName,o=e.avifSrc,a=e.webpSrc,l=e.src,i=e.alt;return(0,n.jsxs)("picture",{className:t,children:[o&&(0,n.jsx)("source",{srcSet:o,type:"image/avif"}),a&&(0,n.jsx)("source",{srcSet:a,type:"image/webp"}),(0,n.jsx)("img",{className:r,src:l,alt:i})]})}},86471:function(e,t,r){"use strict";var n=r(67294),o=r(5189),a=r(51775),l=r(85893);t.Z=function(e){return(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(o.Z,{}),(0,l.jsx)(a.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},17158:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/flutter/dio-upload-file",function(){return r(66022)}])},96865:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},10534:function(e){e.exports={antdHeader:"nav_antdHeader__eCvl0",header:"nav_header__y1mlw",headerLeft:"nav_headerLeft__PrT7_",headerRight:"nav_headerRight__JfqYP",navList:"nav_navList__3HXot",navListItem:"nav_navListItem__hpAdz",switchAddress:"nav_switchAddress__sVzqD",githubLink:"nav_githubLink__BDzSl",switchAddressIcon:"nav_switchAddressIcon__KLxGG"}},77703:function(e){e.exports={tag:"dioUploadFile_tag__lLjR9"}}},function(e){e.O(0,[4322,1447,9166,9774,2888,179],function(){return e(e.s=17158)}),_N_E=e.O()}]);