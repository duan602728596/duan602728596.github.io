(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8747],{94034:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/file-system-access-api",function(){return t(64407)}])},64407:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return A}});var i=t(85893),s=t(67294),c=t(9008),a=t.n(c),r=t(66252),l=t(57307),o=t(26219),d=t(41577),p=t(21652);let h={"image/png":[".png"],"image/jpeg":[".jpeg",".jpg"],"image/webp":[".webp"],"image/avif":[".avif"]},m={types:[{description:"图片",accept:h}]};var u=function(e){let[n,t]=(0,s.useState)(null);async function c(e){try{let[e]=await window.showOpenFilePicker(m),n=await e.getFile(),i=await n.arrayBuffer(),s=function(e){let n=e.match(/\.[a-zA-Z0-9]+$/);if(!n)return null;switch(n[0]){case".png":case".jpg":case".jpeg":return"image/png";case".webp":return"image/webp";case".avif":return"image/avif"}}(n.name),c=new Blob([i],{type:s});t({src:URL.createObjectURL(c),content:i,mime:s})}catch(e){console.error(e)}}async function a(e){if(n)try{let e=await window.showSaveFilePicker({types:[{description:"图片",accept:{[n.mime]:h[n.mime]}}]}),t=await e.createWritable();await t.write(n.content),await t.close()}catch(e){console.error(e)}}return[(0,i.jsxs)(p.ZP.Group,{children:[(0,i.jsx)(p.ZP,{onClick:c,children:"加载图片"}),(0,i.jsx)(p.ZP,{onClick:a,children:"保存图片"})]},"button-group"),(0,i.jsx)("div",{className:"my-[16px]",children:n?.src?(0,i.jsx)("img",{className:"block max-w-full",src:n.src}):null},"image")]},x=t(11151);function j(e){let n={code:"code",pre:"pre",...(0,x.a)(),...e.components};return(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const [fileHandle] = await window.showOpenFilePicker();\nconst file = await fileHandle.getFile();\nconst content = await file.arrayBuffer();\nconst blob = new Blob([content], { type: 'image/png' });\nconst img = document.createElement('img');\n\ndocument.body.appendChild(img);\nimg.src = URL.createObjectURL(blob);\n"})})}function w(e={}){let{wrapper:n}={...(0,x.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(j,{...e})}):j(e)}function f(e){let n={code:"code",pre:"pre",...(0,x.a)(),...e.components};return(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const handle = await window.showSaveFilePicker({\n  types: [{\n    description: 'Test files',\n    accept: {\n      'image/png': ['.png']\n    }\n  }]\n});\nconst writable = await handle.createWritable();\n\nawait writable.write(content);\nawait writable.close();\n"})})}function g(e={}){let{wrapper:n}={...(0,x.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(f,{...e})}):f(e)}let{Title:y,Paragraph:b,Text:P}=r.default;var _=function(e){return(0,i.jsxs)(o.Z,{children:[(0,i.jsx)(y,{children:"使用File System Access API访问文件"}),(0,i.jsx)(b,{children:"最新的File System Access API可以访问文件系统，完成文件的读取和保存。"}),(0,i.jsxs)(b,{children:["使用",(0,i.jsx)(P,{code:!0,children:"window.showOpenFilePicker"}),"获取",(0,i.jsx)(P,{code:!0,children:"fileHandle"}),"，完成文件的读取。"]}),(0,i.jsx)(w,{}),(0,i.jsxs)(b,{children:["使用",(0,i.jsx)(P,{code:!0,children:"window.showSaveFilePicker"}),"获取",(0,i.jsx)(P,{code:!0,children:"handle"}),"，完成文件的保存。"]}),(0,i.jsx)(g,{}),(0,i.jsx)(b,{children:"这个Demo展示了如何加载图片和保存图片。"}),(0,i.jsx)(u,{}),(0,i.jsx)(l.Z,{type:"info",message:[(0,i.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,i.jsxs)("div",{className:"py-[8px]",children:["Getting Started With the File System Access API：",(0,i.jsx)(d.Z,{href:"https://css-tricks.com/getting-started-with-the-file-system-access-api/",children:"https://css-tricks.com/getting-started-with-the-file-system-access-api/"})]},"getting-started-with-the-file-system-access-api"),(0,i.jsxs)("div",{className:"py-[8px]",children:["File_System_Access_API：",(0,i.jsx)(d.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API",children:"https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API"})]},"file"),(0,i.jsxs)("div",{className:"py-[8px]",children:["FileAPI：",(0,i.jsx)(d.Z,{href:"https://w3c.github.io/FileAPI/",children:"https://w3c.github.io/FileAPI/"})]},"fileAPI")]})]})};function A(e){return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsxs)(a(),{children:[(0,i.jsx)("title",{children:"使用File System Access API访问文件"}),(0,i.jsx)("meta",{name:"keywords",content:"前端, js, javascript, File System Access API"}),(0,i.jsx)("meta",{name:"description",content:"使用File System Access API访问文件"})]}),(0,i.jsx)(_,{})]})}},94914:function(e,n,t){"use strict";var i=t(85893),s=t(73935),c=t(39332),a=t(29155),r=t(21652),l=t(70612),o=t(30448),d=t(76467),p=t(1294),h=t.n(p);let{BackTop:m}=a.default;n.Z=function(e){let n=(0,c.useRouter)();return[(0,i.jsxs)("div",{className:h().main,children:[e.goBack?(0,i.jsx)("div",{className:"mb-[16px] text-right",children:(0,i.jsxs)(r.ZP,{onClick:function(e){n.push("/")},children:[(0,i.jsx)(o.Z,{className:"mr-[6px]"}),"返回"]})}):null,e?.children]},"main"),e?.goToTop?(0,i.jsx)(d.default,{children:"object"==typeof document?(0,s.createPortal)((0,i.jsx)(m,{type:"primary",icon:(0,i.jsx)(l.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop"):null]}},26219:function(e,n,t){"use strict";var i=t(85893),s=t(66252),c=t(94914);n.Z=function(e){return(0,i.jsx)(c.Z,{goToTop:!0,goBack:!0,children:(0,i.jsx)(s.default,{children:e.children})})}},1294:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}}},function(e){e.O(0,[1652,5361,7307,2888,9774,179],function(){return e(e.s=94034)}),_N_E=e.O()}]);