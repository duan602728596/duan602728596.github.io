(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9955],{5467:function(e,n,t){"use strict";function r(e){return Object.keys(e).reduce((n,t)=>((t.startsWith("data-")||t.startsWith("aria-")||"role"===t)&&!t.startsWith("data-__")&&(n[t]=e[t]),n),{})}t.d(n,{Z:function(){return r}})},99138:function(e,n,t){"use strict";t.d(n,{Z:function(){return z}});var r=t(76278),o=t(41322),i=t(84481),a=t(26702),s=t(1558),l=t(94184),c=t.n(l),d=t(62874),u=t(67294),m=t(53124),h=t(5467),p=t(96159),f=t(15671),v=t(43144),g=t(32531),x=t(73568);let b=function(e){(0,g.Z)(t,e);var n=(0,x.Z)(t);function t(){var e;return(0,f.Z)(this,t),e=n.apply(this,arguments),e.state={error:void 0,info:{componentStack:""}},e}return(0,v.Z)(t,[{key:"componentDidCatch",value:function(e,n){this.setState({error:e,info:n})}},{key:"render",value:function(){let{message:e,description:n,children:t}=this.props,{error:r,info:o}=this.state,i=o&&o.componentStack?o.componentStack:null,a=void 0===e?(r||"").toString():e;return r?u.createElement(z,{type:"error",message:a,description:u.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},void 0===n?i:n)}):t}}]),t}(u.Component);var j=t(67968),w=t(45503),_=t(14747);let Z=(e,n,t,r,o)=>({backgroundColor:e,border:`${r.lineWidth}px ${r.lineType} ${n}`,[`${o}-icon`]:{color:t}}),$=e=>{let{componentCls:n,motionDurationSlow:t,marginXS:r,marginSM:o,fontSize:i,fontSizeLG:a,lineHeight:s,borderRadiusLG:l,motionEaseInOutCirc:c,alertIconSizeLG:d,colorText:u,paddingContentVerticalSM:m,alertPaddingHorizontal:h,paddingMD:p,paddingContentHorizontalLG:f}=e;return{[n]:Object.assign(Object.assign({},(0,_.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:`${m}px ${h}px`,wordWrap:"break-word",borderRadius:l,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-content`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:i,lineHeight:s},"&-message":{color:u},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${t} ${c}, opacity ${t} ${c},
        padding-top ${t} ${c}, padding-bottom ${t} ${c},
        margin-bottom ${t} ${c}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${n}-with-description`]:{alignItems:"flex-start",paddingInline:f,paddingBlock:p,[`${n}-icon`]:{marginInlineEnd:o,fontSize:d,lineHeight:0},[`${n}-message`]:{display:"block",marginBottom:r,color:u,fontSize:a},[`${n}-description`]:{display:"block"}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},N=e=>{let{componentCls:n,colorSuccess:t,colorSuccessBorder:r,colorSuccessBg:o,colorWarning:i,colorWarningBorder:a,colorWarningBg:s,colorError:l,colorErrorBorder:c,colorErrorBg:d,colorInfo:u,colorInfoBorder:m,colorInfoBg:h}=e;return{[n]:{"&-success":Z(o,r,t,e,n),"&-info":Z(h,m,u,e,n),"&-warning":Z(s,a,i,e,n),"&-error":Object.assign(Object.assign({},Z(d,c,l,e,n)),{[`${n}-description > pre`]:{margin:0,padding:0}})}}},k=e=>{let{componentCls:n,iconCls:t,motionDurationMid:r,marginXS:o,fontSizeIcon:i,colorIcon:a,colorIconHover:s}=e;return{[n]:{"&-action":{marginInlineStart:o},[`${n}-close-icon`]:{marginInlineStart:o,padding:0,overflow:"hidden",fontSize:i,lineHeight:`${i}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${t}-close`]:{color:a,transition:`color ${r}`,"&:hover":{color:s}}},"&-close-text":{color:a,transition:`color ${r}`,"&:hover":{color:s}}}}},y=e=>[$(e),N(e),k(e)];var E=(0,j.Z)("Alert",e=>{let{fontSizeHeading3:n}=e,t=(0,w.TS)(e,{alertIconSizeLG:n,alertPaddingHorizontal:12});return[y(t)]}),C=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>n.indexOf(r)&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>n.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]]);return t};let S={success:r.Z,info:s.Z,error:o.Z,warning:a.Z},T=e=>{let{icon:n,prefixCls:t,type:r}=e,o=S[r]||null;return n?(0,p.wm)(n,u.createElement("span",{className:`${t}-icon`},n),()=>({className:c()(`${t}-icon`,{[n.props.className]:n.props.className})})):u.createElement(o,{className:`${t}-icon`})},I=e=>{let{isClosable:n,closeText:t,prefixCls:r,closeIcon:o,handleClose:i}=e;return n?u.createElement("button",{type:"button",onClick:i,className:`${r}-close-icon`,tabIndex:0},t?u.createElement("span",{className:`${r}-close-text`},t):o):null},L=e=>{var{description:n,prefixCls:t,message:r,banner:o,className:a,rootClassName:s,style:l,onMouseEnter:p,onMouseLeave:f,onClick:v,afterClose:g,showIcon:x,closable:b,closeText:j,closeIcon:w=u.createElement(i.Z,null),action:_}=e,Z=C(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]);let[$,N]=u.useState(!1),k=u.useRef(),{getPrefixCls:y,direction:S}=u.useContext(m.E_),L=y("alert",t),[z,O]=E(L),R=e=>{var n;N(!0),null===(n=Z.onClose)||void 0===n||n.call(Z,e)},B=!!j||b,H=(()=>{let{type:e}=Z;return void 0!==e?e:o?"warning":"info"})(),P=!!o&&void 0===x||x,A=c()(L,`${L}-${H}`,{[`${L}-with-description`]:!!n,[`${L}-no-icon`]:!P,[`${L}-banner`]:!!o,[`${L}-rtl`]:"rtl"===S},a,s,O),M=(0,h.Z)(Z);return z(u.createElement(d.Z,{visible:!$,motionName:`${L}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:g},e=>{let{className:t,style:o}=e;return u.createElement("div",Object.assign({ref:k,"data-show":!$,className:c()(A,t),style:Object.assign(Object.assign({},l),o),onMouseEnter:p,onMouseLeave:f,onClick:v,role:"alert"},M),P?u.createElement(T,{description:n,icon:Z.icon,prefixCls:L,type:H}):null,u.createElement("div",{className:`${L}-content`},r?u.createElement("div",{className:`${L}-message`},r):null,n?u.createElement("div",{className:`${L}-description`},n):null),_?u.createElement("div",{className:`${L}-action`},_):null,u.createElement(I,{isClosable:!!B,closeText:j,prefixCls:L,closeIcon:w,handleClose:R}))}))};L.ErrorBoundary=b;var z=L},76278:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(1413),o=t(67294),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},a=t(93771),s=function(e,n){return o.createElement(a.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:i}))};s.displayName="CheckCircleFilled";var l=o.forwardRef(s)},26702:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(1413),o=t(67294),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},a=t(93771),s=function(e,n){return o.createElement(a.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:i}))};s.displayName="ExclamationCircleFilled";var l=o.forwardRef(s)},1558:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(1413),o=t(67294),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},a=t(93771),s=function(e,n){return o.createElement(a.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:i}))};s.displayName="InfoCircleFilled";var l=o.forwardRef(s)},60576:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return b}});var r=t(67294),o=t(9008),i=t.n(o),a=t(48726),s=t(99138),l=t(22410),c=t(30755),d=t(67552),u=t.n(d),m=t(85893),h=t(11151);function p(e){var n=u()({pre:"pre",code:"code"},(0,h.ah)(),e.components);return(0,m.jsx)(n.pre,{children:(0,m.jsx)(n.code,{className:"language-javascript",children:"console.log(1);\n\nnew Promise((resolve) => {\n  console.log(2);\n  resolve();\n}).then(() => {\n  console.log(3);\n});\n\nsetTimeout(() => {\n  console.log(4);\n}, 0);\n\nnew Promise((resolve) => {\n  console.log(5);\n  resolve();\n}).then(() => {\n  console.log(6);\n});\n"})})}var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=u()({},(0,h.ah)(),e.components).wrapper;return n?(0,m.jsx)(n,u()({},e,{children:(0,m.jsx)(p,e)})):p(e)},v=a.Z.Title,g=a.Z.Paragraph,x=function(e){return(0,m.jsxs)(l.Z,{children:[(0,m.jsx)(v,{children:"浏览器事件循环"}),(0,m.jsxs)(g,{children:[(0,m.jsx)("blockquote",{children:"浏览器需要事件循环来协调事件、用户操作、脚本执行、渲染、网络请求等。通过事件循环，浏览器可以利用任务队列来管理任务， 让异步事件非阻塞地执行。每个客户端对应的事件循环是相对独立的。"}),(0,m.jsxs)("blockquote",{children:["浏览器事件循环是以浏览器为宿主环境实现的事件调度，操作顺序如下：",(0,m.jsxs)("ol",{children:[(0,m.jsx)("li",{children:"执行同步代码。"}),(0,m.jsx)("li",{children:"执行一个宏任务（执行栈中没有就从任务队列中获取）。"}),(0,m.jsx)("li",{children:"执行过程中如果遇到微任务，就将它添加到微任务的任务队列中。"}),(0,m.jsx)("li",{children:"宏任务执行完毕后，立即执行当前微任务队列中的所有微任务（依次执行）。"}),(0,m.jsx)("li",{children:"当前宏任务执行完毕，开始检查渲染，然后渲染线程接管进行渲染。"}),(0,m.jsx)("li",{children:"渲染完毕后，JavaScript 线程继续接管，开始下一个循环。"})]})]})]}),(0,m.jsx)(g,{children:"这是一个经典的题目："}),(0,m.jsx)(f,{}),(0,m.jsx)(g,{children:"输出："}),(0,m.jsx)(c.Z,{type:"text",children:"1\n2\n5\n3\n6\n4"}),(0,m.jsx)(v,{level:2,children:"setTimeout和setInterval"}),(0,m.jsx)(g,{children:"setTimeout和setInterval的运行机制是，将指定的代码移出本次执行，等到下一轮Event Loop时，再检查是否到了指定时间。 如果到了，就执行对应的代码；如果不到，就等到再下一轮Event Loop时重新判断。 这意味着，setTimeout指定的代码，必须等到本次执行的所有代码都执行完，才会执行。"}),(0,m.jsx)(g,{children:"零延迟（Zero delay）并不是意味着回调会立即执行。在零延迟调用setTimeout时，其并不是过了给定的时间间隔后就马上执行回调函数。 其等待的时间基于队列里正在等待的消息数量。也就是说，setTimeout()只是将事件插入了任务队列，必须等到当前代码（执行栈）执行完， 主线程才会去执行它指定的回调函数。要是当前代码耗时很长，有可能要等很久，所以并没有办法保证回调函数一定会在setTimeout()指定的时间执行。"}),(0,m.jsx)(s.Z,{type:"info",message:[(0,m.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,m.jsx)("div",{className:"py-[8px]",children:(0,m.jsx)("a",{href:"https://febook.hzfe.org/awesome-interview/book3/browser-event-loop",target:"_blank",rel:"noopener noreferrer",children:"https://febook.hzfe.org/awesome-interview/book3/browser-event-loop"})},"febook"),(0,m.jsx)("div",{className:"py-[8px]",children:(0,m.jsx)("a",{href:"https://www.jianshu.com/p/73164966c6fe",target:"_blank",rel:"noopener noreferrer",children:"https://www.jianshu.com/p/73164966c6fe"})},"jianshu")]})]})};function b(e){return(0,m.jsxs)(r.Fragment,{children:[(0,m.jsxs)(i(),{children:[(0,m.jsx)("title",{children:"浏览器事件循环"}),(0,m.jsx)("meta",{name:"keywords",content:"浏览器事件循环"}),(0,m.jsx)("meta",{name:"description",content:"浏览器事件循环"})]}),(0,m.jsx)(x,{})]})}},54892:function(e,n,t){"use strict";var r=t(19623),o=t(73935),i=t(11163),a=t(1472),s=t(18662),l=t(75162),c=t(37653),d=t(76467),u=t(3744),m=t.n(u),h=t(85893),p=a.Z.BackTop;n.Z=function(e){var n=(0,i.useRouter)();return[(0,h.jsxs)("div",{className:m().main,children:[e.goBack?(0,h.jsx)("div",{className:"mb-[16px] text-right",children:(0,h.jsxs)(s.ZP,{onClick:function(e){n.push("/")},children:[(0,h.jsx)(c.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,h.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,r.Z)(document))==="object"?(0,o.createPortal)((0,h.jsx)(p,{type:"primary",icon:(0,h.jsx)(l.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},34341:function(e,n,t){"use strict";t(74916);var r=t(88946),o=t.n(r),i=t(81290),a=t.n(i),s=t(41664),l=t.n(s),c=t(97183),d=t(26713),u=t(83062),m=t(67337),h=t(62139),p=t.n(h),f=t(30654),v=t(85893),g=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],x=["github.io","vercel.app"],b=o()(g).call(g,function(e,n){return(0,v.jsx)("li",{className:p().navListItem,children:(0,v.jsx)(l(),{href:e.href,children:e.title})},e.href)});n.Z=function(e){return(0,v.jsx)(c.Z.Header,{className:p().antdHeader,children:(0,v.jsxs)("div",{className:p().header,children:[(0,v.jsx)("nav",{className:p().headerLeft,children:(0,v.jsx)("ul",{className:p().navList,children:b})}),(0,v.jsx)("div",{className:p().headerRight,children:(0,v.jsxs)(d.Z,{size:16,children:[(0,v.jsx)(u.Z,{title:"切换网站地址",children:(0,v.jsx)("a",{className:p().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var n=window.location,t=n.pathname,r=n.hostname,o=/github\.io/.test(r);window.location.href=new(a())(t,"https://duan602728596.".concat(x[o?1:0],"/"))},children:(0,v.jsx)(m.Z,{className:p().switchAddressIcon})})}),(0,v.jsx)("a",{className:p().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,v.jsx)(f.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},30654:function(e,n,t){"use strict";var r=t(85893);n.Z=function(e){var n=e.className,t=e.imageClassName,o=e.avifSrc,i=e.webpSrc,a=e.src,s=e.alt;return(0,r.jsxs)("picture",{className:n,children:[o&&(0,r.jsx)("source",{srcSet:o,type:"image/avif"}),i&&(0,r.jsx)("source",{srcSet:i,type:"image/webp"}),(0,r.jsx)("img",{className:t,src:a,alt:s})]})}},22410:function(e,n,t){"use strict";var r=t(67294),o=t(34341),i=t(54892),a=t(85893);n.Z=function(e){return(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)(o.Z,{}),(0,a.jsx)(i.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},56887:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-event-loop",function(){return t(60576)}])},3744:function(e){e.exports={main:"main_main__ovwFV",goToTop:"main_goToTop__Soij4"}},62139:function(e){e.exports={antdHeader:"nav_antdHeader__pc6AA",header:"nav_header__K7RoR",headerLeft:"nav_headerLeft__D5kPR",headerRight:"nav_headerRight__plZ1z",navList:"nav_navList__iDQNr",navListItem:"nav_navListItem__UblqT",switchAddress:"nav_switchAddress__vhjXS",githubLink:"nav_githubLink__1sY1n",switchAddressIcon:"nav_switchAddressIcon__e5KfQ"}}},function(e){e.O(0,[5876,4796,4940,9774,2888,179],function(){return e(e.s=56887)}),_N_E=e.O()}]);