(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4602],{33438:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return K}});var t=r(67294),i=r(9008),a=r.n(i),s=r(76315),c=r(38925),l=r(55147),o=r(19668),d=r(33938),u=r(30222),h=r.n(u),p=r(99595),v=r.n(p),f=r(81290),m=r.n(f),x=r(10154),j=r(70859),g=r(78957),_=r(18610),b=r(31305),y=r.n(b),N=r(85893),Z=function(e){var n=(0,t.useRef)(null);function r(){var e;if(null!=n&&null!==(e=n.current)&&void 0!==e&&e.srcObject){var r=n.current.srcObject.getTracks();v()(r).call(r,function(e){return e.stop()}),n.current.srcObject=null}}function i(){return(i=(0,d.Z)(h().mark(function e(t){var i;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1});case 3:(i=e.sent).addEventListener("inactive",function(){r()}),"srcObject"in n.current?(n.current.srcObject=i,n.current.play()):n.current.src=m().createObjectURL(i),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),x.ZP.error("屏幕共享失败！");case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}return(0,t.useLayoutEffect)(function(){return function(){r()}},[]),(0,N.jsx)(j.Z,{title:"屏幕共享",extra:(0,N.jsxs)(g.Z,{children:[(0,N.jsx)(_.ZP,{type:"primary",onClick:function(e){return i.apply(this,arguments)},children:"开始屏幕共享"}),(0,N.jsx)(_.ZP,{type:"primary",danger:!0,onClick:function(e){r()},children:"结束屏幕共享"})]}),children:(0,N.jsx)("video",{ref:n,className:y().video})})},w=r(62079),S=r.n(w),P=r(52020),k=r.n(P),I=r(73324),A=r.n(I),C=r(88546),T=r.n(C),D=r(66775),z=r.n(D),L=r(2201),M=r.n(L),O=r(57445),W=r.n(O),R=r(44845),E=r(11151);function U(e,n){var r=S()(e);if(k()){var t=k()(e);n&&(t=A()(t).call(t,function(n){return T()(e,n).enumerable})),r.push.apply(r,t)}return r}function H(e){for(var n=1;n<arguments.length;n++){var r,t,i=null!=arguments[n]?arguments[n]:{};n%2?v()(r=U(Object(i),!0)).call(r,function(n){(0,R.Z)(e,n,i[n])}):z()?M()(e,z()(i)):v()(t=U(Object(i))).call(t,function(n){W()(e,n,T()(i,n))})}return e}function B(e){var n=H(H({code:"code",pre:"pre"},(0,E.a)()),e.components);return(0,N.jsx)(n.pre,{children:(0,N.jsx)(n.code,{className:"language-javascript",children:"async function screenSharing() {\n  const video = document.querySelector('video');\n  const stream = await navigator.mediaDevices.getDisplayMedia({\n    video: { cursor: 'always' },\n    audio: false\n  });\n\n  video.srcObject = stream;\n  video.play();\n}\n"})})}function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=H(H({},(0,E.a)()),e.components).wrapper;return n?(0,N.jsx)(n,H(H({},e),{},{children:(0,N.jsx)(B,H({},e))})):B(e)}var q=s.Z.Title,F=s.Z.Paragraph,G=s.Z.Text,J=function(e){return(0,N.jsxs)(l.Z,{children:[(0,N.jsx)(q,{children:"浏览器中实现屏幕共享功能"}),(0,N.jsxs)(F,{children:["在面试中，会出现一个经常用到的功能，就是在浏览器中实现屏幕共享。该功能使用了",(0,N.jsx)(G,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"API。"]}),(0,N.jsx)(q,{level:2,children:"基本代码"}),(0,N.jsxs)(F,{children:["使用",(0,N.jsx)(G,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"录制，并放到video中。"]}),(0,N.jsx)(X,{}),(0,N.jsx)(q,{level:2,children:"实现效果：屏幕共享并放到video中"}),(0,N.jsx)("div",{className:"mb-[16px]",children:(0,N.jsx)(Z,{})}),(0,N.jsx)(c.Z,{type:"info",message:[(0,N.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,N.jsxs)("div",{className:"py-[8px]",children:["使用屏幕捕获API：",(0,N.jsx)(o.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture"})]},"using-screencapture"),(0,N.jsxs)("div",{className:"py-[8px]",children:["MediaDevices.getDisplayMedia()：",(0,N.jsx)(o.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia"})]},"getDisplayMedia"),(0,N.jsxs)("div",{className:"py-[8px]",children:["MediaStream：",(0,N.jsx)(o.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream"})]},"MediaStream"),(0,N.jsxs)("div",{className:"py-[8px]",children:["信令与视频通话：",(0,N.jsx)(o.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling"})]},"Signaling-and-video-calling")]})]})};function K(e){return(0,N.jsxs)(t.Fragment,{children:[(0,N.jsxs)(a(),{children:[(0,N.jsx)("title",{children:"浏览器中实现屏幕共享功能"}),(0,N.jsx)("meta",{name:"keywords",content:"前端, javascript"}),(0,N.jsx)("meta",{name:"description",content:"浏览器中实现屏幕共享功能"})]}),(0,N.jsx)(J,{})]})}},19668:function(e,n,r){"use strict";var t=r(85893);n.Z=function(e){var n=e.href,r=e.className,i=e.children;return(0,t.jsx)("a",{className:r,href:n,target:"_blank",rel:"noopener noreferrer",children:i})}},39243:function(e,n,r){"use strict";var t=r(19623),i=r(73935),a=r(11163),s=r(81860),c=r(18610),l=r(75162),o=r(6171),d=r(76467),u=r(63791),h=r.n(u),p=r(85893),v=s.Z.BackTop;n.Z=function(e){var n=(0,a.useRouter)();return[(0,p.jsxs)("div",{className:h().main,children:[e.goBack?(0,p.jsx)("div",{className:"mb-[16px] text-right",children:(0,p.jsxs)(c.ZP,{onClick:function(e){n.push("/")},children:[(0,p.jsx)(o.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,p.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,t.Z)(document))==="object"?(0,i.createPortal)((0,p.jsx)(v,{type:"primary",icon:(0,p.jsx)(l.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},31725:function(e,n,r){"use strict";r(64043);var t=r(88946),i=r.n(t),a=r(81290),s=r.n(a),c=r(41664),l=r.n(c),o=r(21612),d=r(78957),u=r(83062),h=r(67337),p=r(32958),v=r.n(p),f=r(96808),m=r(19668),x=r(85893),j=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],g=["github.io","vercel.app"],_=i()(j).call(j,function(e,n){return(0,x.jsx)("li",{className:v().navListItem,children:(0,x.jsx)(l(),{href:e.href,children:e.title})},e.href)});n.Z=function(e){return(0,x.jsx)(o.Z.Header,{className:v().antdHeader,children:(0,x.jsxs)("div",{className:v().header,children:[(0,x.jsx)("nav",{className:v().headerLeft,children:(0,x.jsx)("ul",{className:v().navList,children:_})}),(0,x.jsx)("div",{className:v().headerRight,children:(0,x.jsxs)(d.Z,{size:16,children:[(0,x.jsx)(u.Z,{title:"切换网站地址",children:(0,x.jsx)("a",{className:v().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var n=window.location,r=n.pathname,t=n.hostname,i=/github\.io/.test(t);window.location.href=new(s())(r,"https://duan602728596.".concat(g[i?1:0],"/"))},children:(0,x.jsx)(h.Z,{className:v().switchAddressIcon})})}),(0,x.jsx)(m.Z,{className:v().githubLink,href:"https://github.com/duan602728596",children:(0,x.jsx)(f.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},96808:function(e,n,r){"use strict";var t=r(85893);n.Z=function(e){var n=e.className,r=e.imageClassName,i=e.avifSrc,a=e.webpSrc,s=e.src,c=e.alt;return(0,t.jsxs)("picture",{className:n,children:[i&&(0,t.jsx)("source",{srcSet:i,type:"image/avif"}),a&&(0,t.jsx)("source",{srcSet:a,type:"image/webp"}),(0,t.jsx)("img",{className:r,src:s,alt:c})]})}},55147:function(e,n,r){"use strict";var t=r(67294),i=r(31725),a=r(39243),s=r(85893);n.Z=function(e){return(0,s.jsxs)(t.Fragment,{children:[(0,s.jsx)(i.Z,{}),(0,s.jsx)(a.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},88096:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-screen-sharing",function(){return r(33438)}])},63791:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},32958:function(e){e.exports={antdHeader:"nav_antdHeader__eCvl0",header:"nav_header__y1mlw",headerLeft:"nav_headerLeft__PrT7_",headerRight:"nav_headerRight__JfqYP",navList:"nav_navList__3HXot",navListItem:"nav_navListItem__hpAdz",switchAddress:"nav_switchAddress__sVzqD",githubLink:"nav_githubLink__BDzSl",switchAddressIcon:"nav_switchAddressIcon__KLxGG"}},31305:function(e){e.exports={video:"screenSharingTest_video__pRDa2"}},33938:function(e,n,r){"use strict";r.d(n,{Z:function(){return a}});var t=r(890);function i(e,n,r,i,a,s,c){try{var l=e[s](c),o=l.value}catch(e){r(e);return}l.done?n(o):t.resolve(o).then(i,a)}function a(e){return function(){var n=this,r=arguments;return new t(function(t,a){var s=e.apply(n,r);function c(e){i(s,t,a,c,l,"next",e)}function l(e){i(s,t,a,c,l,"throw",e)}c(void 0)})}}}},function(e){e.O(0,[8610,1447,4530,8925,3791,8791,859,154,9774,2888,179],function(){return e(e.s=88096)}),_N_E=e.O()}]);