(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4602],{88096:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-screen-sharing",function(){return i(18091)}])},18091:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return Z}});var s=i(85893),r=i(67294),t=i(9008),a=i.n(t),c=i(76315),l=i(38925),o=i(30673),d=i(39182),h=i(68872),u=i(70859),p=i(78957),v=i(10932),m=i(31305),g=i.n(m),x=function(e){let n=(0,r.useRef)(null);function i(){var e;(null==n?void 0:null===(e=n.current)||void 0===e?void 0:e.srcObject)&&(n.current.srcObject.getTracks().forEach(e=>e.stop()),n.current.srcObject=null)}async function t(e){try{let e=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1});e.addEventListener("inactive",function(){i()}),"srcObject"in n.current?(n.current.srcObject=e,n.current.play()):n.current.src=window.URL.createObjectURL(e)}catch(e){console.error(e),h.ZP.error("屏幕共享失败！")}}return(0,r.useLayoutEffect)(function(){return function(){i()}},[]),(0,s.jsx)(u.Z,{title:"屏幕共享",extra:(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(v.ZP,{type:"primary",onClick:t,children:"开始屏幕共享"}),(0,s.jsx)(v.ZP,{type:"primary",danger:!0,onClick:function(e){i()},children:"结束屏幕共享"})]}),children:(0,s.jsx)("video",{ref:n,className:g().video})})},f=i(11151);function j(e){let n={code:"code",pre:"pre",...(0,f.a)(),...e.components};return(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function screenSharing() {\n  const video = document.querySelector('video');\n  const stream = await navigator.mediaDevices.getDisplayMedia({\n    video: { cursor: 'always' },\n    audio: false\n  });\n\n  video.srcObject = stream;\n  video.play();\n}\n"})})}function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}={...(0,f.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(j,{...e})}):j(e)}let{Title:b,Paragraph:y,Text:N}=c.default;var w=function(e){return(0,s.jsxs)(o.Z,{children:[(0,s.jsx)(b,{children:"浏览器中实现屏幕共享功能"}),(0,s.jsxs)(y,{children:["在面试中，会出现一个经常用到的功能，就是在浏览器中实现屏幕共享。该功能使用了",(0,s.jsx)(N,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"API。"]}),(0,s.jsx)(b,{level:2,children:"基本代码"}),(0,s.jsxs)(y,{children:["使用",(0,s.jsx)(N,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"录制，并放到video中。"]}),(0,s.jsx)(_,{}),(0,s.jsx)(b,{level:2,children:"实现效果：屏幕共享并放到video中"}),(0,s.jsx)("div",{className:"mb-[16px]",children:(0,s.jsx)(x,{})}),(0,s.jsx)(l.Z,{type:"info",message:[(0,s.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,s.jsxs)("div",{className:"py-[8px]",children:["使用屏幕捕获API：",(0,s.jsx)(d.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture"})]},"using-screencapture"),(0,s.jsxs)("div",{className:"py-[8px]",children:["MediaDevices.getDisplayMedia()：",(0,s.jsx)(d.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia"})]},"getDisplayMedia"),(0,s.jsxs)("div",{className:"py-[8px]",children:["MediaStream：",(0,s.jsx)(d.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream"})]},"MediaStream"),(0,s.jsxs)("div",{className:"py-[8px]",children:["信令与视频通话：",(0,s.jsx)(d.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling"})]},"Signaling-and-video-calling")]})]})};function Z(e){return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)(a(),{children:[(0,s.jsx)("title",{children:"浏览器中实现屏幕共享功能"}),(0,s.jsx)("meta",{name:"keywords",content:"前端, javascript"}),(0,s.jsx)("meta",{name:"description",content:"浏览器中实现屏幕共享功能"})]}),(0,s.jsx)(w,{})]})}},39182:function(e,n,i){"use strict";var s=i(85893),r=i(45697),t=i.n(r);function a(e){let{href:n,className:i,children:r}=e;return(0,s.jsx)("a",{className:i,href:n,target:"_blank",rel:"noopener noreferrer",children:r})}a.propTypes={href:t().string.isRequired,className:t().string,children:t().node.isRequired},n.Z=a},99388:function(e,n,i){"use strict";var s=i(85893),r=i(73935),t=i(45697),a=i.n(t),c=i(11163),l=i(81860),o=i(10932),d=i(75162),h=i(6171),u=i(76467),p=i(63791),v=i.n(p);let{BackTop:m}=l.default;function g(e){let n=(0,c.useRouter)();return[(0,s.jsxs)("div",{className:v().main,children:[e.goBack?(0,s.jsx)("div",{className:"mb-[16px] text-right",children:(0,s.jsxs)(o.ZP,{onClick:function(e){n.push("/")},children:[(0,s.jsx)(h.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,s.jsx)(u.default,{children:(null==e?void 0:e.goToTop)&&"object"==typeof document?(0,r.createPortal)((0,s.jsx)(m,{type:"primary",icon:(0,s.jsx)(d.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}g.propTypes={children:a().node,goToTop:a().bool,goBack:a().bool},n.Z=g},43221:function(e,n,i){"use strict";var s=i(85893),r=i(41664),t=i.n(r),a=i(21612),c=i(78957),l=i(83062),o=i(67337),d=i(32958),h=i.n(d),u=i(90791),p=i(39182);let v=["github.io","vercel.app"],m=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}].map((e,n)=>(0,s.jsx)("li",{className:h().navListItem,children:(0,s.jsx)(t(),{href:e.href,children:e.title})},e.href));n.Z=function(e){return(0,s.jsx)(a.Z.Header,{className:h().antdHeader,children:(0,s.jsxs)("div",{className:h().header,children:[(0,s.jsx)("nav",{className:h().headerLeft,children:(0,s.jsx)("ul",{className:h().navList,children:m})}),(0,s.jsx)("div",{className:h().headerRight,children:(0,s.jsxs)(c.Z,{size:16,children:[(0,s.jsx)(l.Z,{title:"切换网站地址",children:(0,s.jsx)("a",{className:h().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){let{pathname:n,hostname:i}=window.location,s=/github\.io/.test(i);window.location.href=new URL(n,"https://duan602728596.".concat(v[s?1:0],"/"))},children:(0,s.jsx)(o.Z,{className:h().switchAddressIcon})})}),(0,s.jsx)(p.Z,{className:h().githubLink,href:"https://github.com/duan602728596",children:(0,s.jsx)(u.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},90791:function(e,n,i){"use strict";var s=i(85893),r=i(45697),t=i.n(r);function a(e){let{className:n,imageClassName:i,avifSrc:r,webpSrc:t,src:a,alt:c}=e;return(0,s.jsxs)("picture",{className:n,children:[r&&(0,s.jsx)("source",{srcSet:r,type:"image/avif"}),t&&(0,s.jsx)("source",{srcSet:t,type:"image/webp"}),(0,s.jsx)("img",{className:i,src:a,alt:c})]})}a.propTypes={className:t().string,imageClassName:t().string,avifSrc:t().string,webpSrc:t().string,src:t().string},n.Z=a},30673:function(e,n,i){"use strict";var s=i(85893),r=i(67294),t=i(45697),a=i.n(t),c=i(43221),l=i(99388);function o(e){return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(c.Z,{}),(0,s.jsx)(l.Z,{goToTop:!0,goBack:!0,children:e.children})]})}o.propTypes={children:a().node},n.Z=o},63791:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},32958:function(e){e.exports={antdHeader:"nav_antdHeader__eCvl0",header:"nav_header__y1mlw",headerLeft:"nav_headerLeft__PrT7_",headerRight:"nav_headerRight__JfqYP",navList:"nav_navList__3HXot",navListItem:"nav_navListItem__hpAdz",switchAddress:"nav_switchAddress__sVzqD",githubLink:"nav_githubLink__BDzSl",switchAddressIcon:"nav_switchAddressIcon__KLxGG"}},31305:function(e){e.exports={video:"screenSharingTest_video__pRDa2"}}},function(e){e.O(0,[932,1447,4530,8925,3791,8791,859,8872,2888,9774,179],function(){return e(e.s=88096)}),_N_E=e.O()}]);