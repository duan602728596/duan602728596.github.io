(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9955],{89739:function(e,n,r){"use strict";r.d(n,{Z:function(){return l}});var t=r(1413),o=r(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},s=r(42135),i=function(e,n){return o.createElement(s.Z,(0,t.Z)((0,t.Z)({},e),{},{ref:n,icon:c}))};i.displayName="CheckCircleFilled";var l=o.forwardRef(i)},21640:function(e,n,r){"use strict";r.d(n,{Z:function(){return l}});var t=r(1413),o=r(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},s=r(42135),i=function(e,n){return o.createElement(s.Z,(0,t.Z)((0,t.Z)({},e),{},{ref:n,icon:c}))};i.displayName="ExclamationCircleFilled";var l=o.forwardRef(i)},78860:function(e,n,r){"use strict";r.d(n,{Z:function(){return l}});var t=r(1413),o=r(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},s=r(42135),i=function(e,n){return o.createElement(s.Z,(0,t.Z)((0,t.Z)({},e),{},{ref:n,icon:c}))};i.displayName="InfoCircleFilled";var l=o.forwardRef(i)},40109:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return w}});var t=r(67294),o=r(9008),c=r.n(o),s=r(76315),i=r(99138),l=r(34065),a=r(7244),h=r(67552),d=r.n(h),u=r(85893),f=r(11151);function x(e){var n=d()({pre:"pre",code:"code"},(0,f.ah)(),e.components);return(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-javascript",children:"console.log(1);\n\nnew Promise((resolve) => {\n  console.log(2);\n  resolve();\n}).then(() => {\n  console.log(3);\n});\n\nsetTimeout(() => {\n  console.log(4);\n}, 0);\n\nnew Promise((resolve) => {\n  console.log(5);\n  resolve();\n}).then(() => {\n  console.log(6);\n});\n"})})}var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=d()({},(0,f.ah)(),e.components).wrapper;return n?(0,u.jsx)(n,d()({},e,{children:(0,u.jsx)(x,e)})):x(e)},p=s.Z.Title,j=s.Z.Paragraph,v=function(e){return(0,u.jsxs)(l.Z,{children:[(0,u.jsx)(p,{children:"浏览器事件循环"}),(0,u.jsxs)(j,{children:[(0,u.jsx)("blockquote",{children:"浏览器需要事件循环来协调事件、用户操作、脚本执行、渲染、网络请求等。通过事件循环，浏览器可以利用任务队列来管理任务， 让异步事件非阻塞地执行。每个客户端对应的事件循环是相对独立的。"}),(0,u.jsxs)("blockquote",{children:["浏览器事件循环是以浏览器为宿主环境实现的事件调度，操作顺序如下：",(0,u.jsxs)("ol",{children:[(0,u.jsx)("li",{children:"执行同步代码。"}),(0,u.jsx)("li",{children:"执行一个宏任务（执行栈中没有就从任务队列中获取）。"}),(0,u.jsx)("li",{children:"执行过程中如果遇到微任务，就将它添加到微任务的任务队列中。"}),(0,u.jsx)("li",{children:"宏任务执行完毕后，立即执行当前微任务队列中的所有微任务（依次执行）。"}),(0,u.jsx)("li",{children:"当前宏任务执行完毕，开始检查渲染，然后渲染线程接管进行渲染。"}),(0,u.jsx)("li",{children:"渲染完毕后，JavaScript 线程继续接管，开始下一个循环。"})]})]})]}),(0,u.jsx)(j,{children:"这是一个经典的题目："}),(0,u.jsx)(m,{}),(0,u.jsx)(j,{children:"输出："}),(0,u.jsx)(a.Z,{type:"text",children:"1\n2\n5\n3\n6\n4"}),(0,u.jsx)(p,{level:2,children:"setTimeout和setInterval"}),(0,u.jsx)(j,{children:"setTimeout和setInterval的运行机制是，将指定的代码移出本次执行，等到下一轮Event Loop时，再检查是否到了指定时间。 如果到了，就执行对应的代码；如果不到，就等到再下一轮Event Loop时重新判断。 这意味着，setTimeout指定的代码，必须等到本次执行的所有代码都执行完，才会执行。"}),(0,u.jsx)(j,{children:"零延迟（Zero delay）并不是意味着回调会立即执行。在零延迟调用setTimeout时，其并不是过了给定的时间间隔后就马上执行回调函数。 其等待的时间基于队列里正在等待的消息数量。也就是说，setTimeout()只是将事件插入了任务队列，必须等到当前代码（执行栈）执行完， 主线程才会去执行它指定的回调函数。要是当前代码耗时很长，有可能要等很久，所以并没有办法保证回调函数一定会在setTimeout()指定的时间执行。"}),(0,u.jsx)(i.Z,{type:"info",message:[(0,u.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,u.jsx)("div",{className:"py-[8px]",children:(0,u.jsx)("a",{href:"https://febook.hzfe.org/awesome-interview/book3/browser-event-loop",target:"_blank",rel:"noopener noreferrer",children:"https://febook.hzfe.org/awesome-interview/book3/browser-event-loop"})},"febook"),(0,u.jsx)("div",{className:"py-[8px]",children:(0,u.jsx)("a",{href:"https://www.jianshu.com/p/73164966c6fe",target:"_blank",rel:"noopener noreferrer",children:"https://www.jianshu.com/p/73164966c6fe"})},"jianshu")]})]})};function w(e){return(0,u.jsxs)(t.Fragment,{children:[(0,u.jsxs)(c(),{children:[(0,u.jsx)("title",{children:"浏览器事件循环"}),(0,u.jsx)("meta",{name:"keywords",content:"浏览器事件循环"}),(0,u.jsx)("meta",{name:"description",content:"浏览器事件循环"})]}),(0,u.jsx)(v,{})]})}},56887:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-event-loop",function(){return r(40109)}])}},function(e){e.O(0,[7960,4796,7646,4921,9774,2888,179],function(){return e(e.s=56887)}),_N_E=e.O()}]);