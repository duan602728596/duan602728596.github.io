(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4602],{88096:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-screen-sharing",function(){return i(63082)}])},63082:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return S}});var r=i(85893),c=i(67294),s=i(9008),t=i.n(s),a=i(25250),o=i(90578),l=i(12424),d=i(74553),u=i(35836),p=i(14223),h=i(62481),x=i(44594),j=i(39552),m=i.n(j),v=function(e){let n=(0,c.useRef)(null);function i(){n?.current?.srcObject&&(n.current.srcObject.getTracks().forEach(e=>e.stop()),n.current.srcObject=null)}async function s(e){try{let e=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1});e.addEventListener("inactive",function(){i()}),"srcObject"in n.current?(n.current.srcObject=e,n.current.play()):n.current.src=window.URL.createObjectURL(e)}catch(e){console.error(e),u.ZP.error("屏幕共享失败！")}}return(0,c.useLayoutEffect)(function(){return function(){i()}},[]),(0,r.jsx)(p.Z,{title:"屏幕共享",extra:(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(x.ZP,{type:"primary",onClick:s,children:"开始屏幕共享"}),(0,r.jsx)(x.ZP,{type:"primary",danger:!0,onClick:function(e){i()},children:"结束屏幕共享"})]}),children:(0,r.jsx)("video",{ref:n,className:m().video})})},g=i(11151);function f(e){let n={code:"code",pre:"pre",...(0,g.a)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function screenSharing() {\n  const video = document.querySelector('video');\n  const stream = await navigator.mediaDevices.getDisplayMedia({\n    video: { cursor: 'always' },\n    audio: false\n  });\n\n  video.srcObject = stream;\n  video.play();\n}\n"})})}function _(e={}){let{wrapper:n}={...(0,g.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(f,{...e})}):f(e)}let{Title:y,Paragraph:b,Text:P}=a.default;var N=function(e){return(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(y,{children:"浏览器中实现屏幕共享功能"}),(0,r.jsxs)(b,{children:["在面试中，会出现一个经常用到的功能，就是在浏览器中实现屏幕共享。该功能使用了",(0,r.jsx)(P,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"API。"]}),(0,r.jsx)(y,{level:2,children:"基本代码"}),(0,r.jsxs)(b,{children:["使用",(0,r.jsx)(P,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"录制，并放到video中。"]}),(0,r.jsx)(_,{}),(0,r.jsx)(y,{level:2,children:"实现效果：屏幕共享并放到video中"}),(0,r.jsx)("div",{className:"mb-[16px]",children:(0,r.jsx)(v,{})}),(0,r.jsx)(o.Z,{type:"info",message:[(0,r.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,r.jsxs)("div",{className:"py-[8px]",children:["使用屏幕捕获API：",(0,r.jsx)(d.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture"})]},"using-screencapture"),(0,r.jsxs)("div",{className:"py-[8px]",children:["MediaDevices.getDisplayMedia()：",(0,r.jsx)(d.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia"})]},"getDisplayMedia"),(0,r.jsxs)("div",{className:"py-[8px]",children:["MediaStream：",(0,r.jsx)(d.Z,{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream"})]},"MediaStream"),(0,r.jsxs)("div",{className:"py-[8px]",children:["信令与视频通话：",(0,r.jsx)(d.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling"})]},"Signaling-and-video-calling")]})]})};function S(e){return(0,r.jsxs)(c.Fragment,{children:[(0,r.jsxs)(t(),{children:[(0,r.jsx)("title",{children:"浏览器中实现屏幕共享功能"}),(0,r.jsx)("meta",{name:"keywords",content:"前端, javascript"}),(0,r.jsx)("meta",{name:"description",content:"浏览器中实现屏幕共享功能"})]}),(0,r.jsx)(N,{})]})}},11035:function(e,n,i){"use strict";var r=i(85893),c=i(73935),s=i(39332),t=i(57140),a=i(44594),o=i(84669),l=i(85486),d=i(76467),u=i(45212),p=i.n(u);let{BackTop:h}=t.default;n.Z=function(e){let n=(0,s.useRouter)();return[(0,r.jsxs)("div",{className:p().main,children:[e.goBack?(0,r.jsx)("div",{className:"mb-[16px] text-right",children:(0,r.jsxs)(a.ZP,{onClick:function(e){n.push("/")},children:[(0,r.jsx)(l.Z,{className:"mr-[6px]"}),"返回"]})}):null,e?.children]},"main"),e?.goToTop?(0,r.jsx)(d.default,{children:"object"==typeof document?(0,c.createPortal)((0,r.jsx)(h,{type:"primary",icon:(0,r.jsx)(o.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop"):null]}},12424:function(e,n,i){"use strict";var r=i(85893),c=i(11035);n.Z=function(e){return(0,r.jsx)(c.Z,{goToTop:!0,goBack:!0,children:e.children})}},45212:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},39552:function(e){e.exports={video:"screenSharingTest_video__pRDa2"}}},function(e){e.O(0,[4594,2409,578,3005,4946,4223,5836,2888,9774,179],function(){return e(e.s=88096)}),_N_E=e.O()}]);