(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4602],{72156:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return z}});var i=r(67294),t=r(9008),a=r.n(t),c=r(76315),s=r(99138),o=r(34065),l=r(33938),d=r(30222),u=r.n(d),p=r(99595),h=r.n(p),v=r(81290),x=r.n(v),f=r(54761),g=r(8635),j=r(26713),m=r(97960),_=r(14005),y=r.n(_),b=r(85893),N=function(e){var n=(0,i.useRef)(null);function r(){var e;if(null!=n&&null!==(e=n.current)&&void 0!==e&&e.srcObject){var r=n.current.srcObject.getTracks();h()(r).call(r,function(e){return e.stop()}),n.current.srcObject=null}}function t(){return(t=(0,l.Z)(u().mark(function e(i){var t;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1});case 3:(t=e.sent).addEventListener("inactive",function(){r()}),"srcObject"in n.current?(n.current.srcObject=t,n.current.play()):n.current.src=x().createObjectURL(t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),f.ZP.error("屏幕共享失败！");case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}return(0,i.useLayoutEffect)(function(){return function(){r()}},[]),(0,b.jsx)(g.Z,{title:"屏幕共享",extra:(0,b.jsxs)(j.Z,{children:[(0,b.jsx)(m.Z,{type:"primary",onClick:function(e){return t.apply(this,arguments)},children:"开始屏幕共享"}),(0,b.jsx)(m.Z,{type:"primary",danger:!0,onClick:function(e){r()},children:"结束屏幕共享"})]}),children:(0,b.jsx)("video",{ref:n,className:y().video})})},P=r(67552),S=r.n(P),w=r(11151);function k(e){var n=S()({pre:"pre",code:"code"},(0,w.ah)(),e.components);return(0,b.jsx)(n.pre,{children:(0,b.jsx)(n.code,{className:"language-javascript",children:"async function screenSharing() {\n  const video = document.querySelector('video');\n  const stream = await navigator.mediaDevices.getDisplayMedia({\n    video: { cursor: 'always' },\n    audio: false\n  });\n\n  video.srcObject = stream;\n  video.play();\n}\n"})})}var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=S()({},(0,w.ah)(),e.components).wrapper;return n?(0,b.jsx)(n,S()({},e,{children:(0,b.jsx)(k,e)})):k(e)},M=c.Z.Title,A=c.Z.Paragraph,C=c.Z.Text,I=function(e){return(0,b.jsxs)(o.Z,{children:[(0,b.jsx)(M,{children:"浏览器中实现屏幕共享功能"}),(0,b.jsxs)(A,{children:["在面试中，会出现一个经常用到的功能，就是在浏览器中实现屏幕共享。该功能使用了",(0,b.jsx)(C,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"API。"]}),(0,b.jsx)(M,{level:2,children:"基本代码"}),(0,b.jsxs)(A,{children:["使用",(0,b.jsx)(C,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"录制，并放到video中。"]}),(0,b.jsx)(D,{}),(0,b.jsx)(M,{level:2,children:"实现效果：屏幕共享并放到video中"}),(0,b.jsx)("div",{className:"mb-[16px]",children:(0,b.jsx)(N,{})}),(0,b.jsx)(s.Z,{type:"info",message:[(0,b.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,b.jsxs)("div",{className:"py-[8px]",children:["使用屏幕捕获API：",(0,b.jsx)("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture"})]},"using-screencapture"),(0,b.jsxs)("div",{className:"py-[8px]",children:["MediaDevices.getDisplayMedia()：",(0,b.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia"})]},"getDisplayMedia"),(0,b.jsxs)("div",{className:"py-[8px]",children:["MediaStream：",(0,b.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream"})]},"MediaStream"),(0,b.jsxs)("div",{className:"py-[8px]",children:["信令与视频通话：",(0,b.jsx)("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling"})]},"Signaling-and-video-calling")]})]})};function z(e){return(0,b.jsxs)(i.Fragment,{children:[(0,b.jsxs)(a(),{children:[(0,b.jsx)("title",{children:"浏览器中实现屏幕共享功能"}),(0,b.jsx)("meta",{name:"keywords",content:"前端, javascript"}),(0,b.jsx)("meta",{name:"description",content:"浏览器中实现屏幕共享功能"})]}),(0,b.jsx)(I,{})]})}},88096:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-screen-sharing",function(){return r(72156)}])},14005:function(e){e.exports={video:"screenSharingTest_video__LkNKa"}},33938:function(e,n,r){"use strict";r.d(n,{Z:function(){return a}});var i=r(35820);function t(e,n,r,t,a,c,s){try{var o=e[c](s),l=o.value}catch(d){r(d);return}o.done?n(l):i.resolve(l).then(t,a)}function a(e){return function(){var n=this,r=arguments;return new i(function(i,a){var c=e.apply(n,r);function s(e){t(c,i,a,s,o,"next",e)}function o(e){t(c,i,a,s,o,"throw",e)}s(void 0)})}}}},function(e){e.O(0,[7960,4796,7646,4011,9827,4761,4921,9774,2888,179],function(){return e(e.s=88096)}),_N_E=e.O()}]);