(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4602],{33438:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return J}});var a=r(67294),t=r(9008),i=r.n(t),s=r(76315),c=r(38925),l=r(55147),o=r(33938),d=r(30222),u=r.n(d),h=r(99595),p=r.n(h),v=r(81290),f=r.n(v),m=r(10154),x=r(70859),g=r(78957),j=r(18610),_=r(31305),b=r.n(_),y=r(85893),w=function(e){var n=(0,a.useRef)(null);function r(){var e;if(null!=n&&null!==(e=n.current)&&void 0!==e&&e.srcObject){var r=n.current.srcObject.getTracks();p()(r).call(r,function(e){return e.stop()}),n.current.srcObject=null}}function t(){return(t=(0,o.Z)(u().mark(function e(a){var t;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1});case 3:(t=e.sent).addEventListener("inactive",function(){r()}),"srcObject"in n.current?(n.current.srcObject=t,n.current.play()):n.current.src=f().createObjectURL(t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),m.ZP.error("屏幕共享失败！");case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}return(0,a.useLayoutEffect)(function(){return function(){r()}},[]),(0,y.jsx)(x.Z,{title:"屏幕共享",extra:(0,y.jsxs)(g.Z,{children:[(0,y.jsx)(j.ZP,{type:"primary",onClick:function(e){return t.apply(this,arguments)},children:"开始屏幕共享"}),(0,y.jsx)(j.ZP,{type:"primary",danger:!0,onClick:function(e){r()},children:"结束屏幕共享"})]}),children:(0,y.jsx)("video",{ref:n,className:b().video})})},N=r(62079),Z=r.n(N),k=r(52020),S=r.n(k),P=r(73324),I=r.n(P),A=r(88546),C=r.n(A),T=r(66775),D=r.n(T),z=r(2201),L=r.n(z),M=r(57445),O=r.n(M),W=r(44845),R=r(11151);function E(e,n){var r=Z()(e);if(S()){var a=S()(e);n&&(a=I()(a).call(a,function(n){return C()(e,n).enumerable})),r.push.apply(r,a)}return r}function U(e){for(var n=1;n<arguments.length;n++){var r,a,t=null!=arguments[n]?arguments[n]:{};n%2?p()(r=E(Object(t),!0)).call(r,function(n){(0,W.Z)(e,n,t[n])}):D()?L()(e,D()(t)):p()(a=E(Object(t))).call(a,function(n){O()(e,n,C()(t,n))})}return e}function H(e){var n=U(U({code:"code",pre:"pre"},(0,R.a)()),e.components);return(0,y.jsx)(n.pre,{children:(0,y.jsx)(n.code,{className:"language-javascript",children:"async function screenSharing() {\n  const video = document.querySelector('video');\n  const stream = await navigator.mediaDevices.getDisplayMedia({\n    video: { cursor: 'always' },\n    audio: false\n  });\n\n  video.srcObject = stream;\n  video.play();\n}\n"})})}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=U(U({},(0,R.a)()),e.components).wrapper;return n?(0,y.jsx)(n,U(U({},e),{},{children:(0,y.jsx)(H,U({},e))})):H(e)}var X=s.Z.Title,q=s.Z.Paragraph,F=s.Z.Text,G=function(e){return(0,y.jsxs)(l.Z,{children:[(0,y.jsx)(X,{children:"浏览器中实现屏幕共享功能"}),(0,y.jsxs)(q,{children:["在面试中，会出现一个经常用到的功能，就是在浏览器中实现屏幕共享。该功能使用了",(0,y.jsx)(F,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"API。"]}),(0,y.jsx)(X,{level:2,children:"基本代码"}),(0,y.jsxs)(q,{children:["使用",(0,y.jsx)(F,{code:!0,children:"navigator.mediaDevices.getDisplayMedia"}),"录制，并放到video中。"]}),(0,y.jsx)(B,{}),(0,y.jsx)(X,{level:2,children:"实现效果：屏幕共享并放到video中"}),(0,y.jsx)("div",{className:"mb-[16px]",children:(0,y.jsx)(w,{})}),(0,y.jsx)(c.Z,{type:"info",message:[(0,y.jsx)("h2",{className:"mb-0 py-[8px] text-[16px]",children:"参考地址："},"cankaodizhi"),(0,y.jsxs)("div",{className:"py-[8px]",children:["使用屏幕捕获API：",(0,y.jsx)("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture"})]},"using-screencapture"),(0,y.jsxs)("div",{className:"py-[8px]",children:["MediaDevices.getDisplayMedia()：",(0,y.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia"})]},"getDisplayMedia"),(0,y.jsxs)("div",{className:"py-[8px]",children:["MediaStream：",(0,y.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream"})]},"MediaStream"),(0,y.jsxs)("div",{className:"py-[8px]",children:["信令与视频通话：",(0,y.jsx)("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling",children:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling"})]},"Signaling-and-video-calling")]})]})};function J(e){return(0,y.jsxs)(a.Fragment,{children:[(0,y.jsxs)(i(),{children:[(0,y.jsx)("title",{children:"浏览器中实现屏幕共享功能"}),(0,y.jsx)("meta",{name:"keywords",content:"前端, javascript"}),(0,y.jsx)("meta",{name:"description",content:"浏览器中实现屏幕共享功能"})]}),(0,y.jsx)(G,{})]})}},39243:function(e,n,r){"use strict";var a=r(19623),t=r(73935),i=r(11163),s=r(81860),c=r(18610),l=r(75162),o=r(6171),d=r(76467),u=r(63791),h=r.n(u),p=r(85893),v=s.Z.BackTop;n.Z=function(e){var n=(0,i.useRouter)();return[(0,p.jsxs)("div",{className:h().main,children:[e.goBack?(0,p.jsx)("div",{className:"mb-[16px] text-right",children:(0,p.jsxs)(c.ZP,{onClick:function(e){n.push("/")},children:[(0,p.jsx)(o.Z,{className:"mr-[6px]"}),"返回"]})}):null,null==e?void 0:e.children]},"main"),(0,p.jsx)(d.default,{children:null!=e&&e.goToTop&&("undefined"==typeof document?"undefined":(0,a.Z)(document))==="object"?(0,t.createPortal)((0,p.jsx)(v,{type:"primary",icon:(0,p.jsx)(l.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop")]}},31725:function(e,n,r){"use strict";r(64043);var a=r(88946),t=r.n(a),i=r(81290),s=r.n(i),c=r(41664),l=r.n(c),o=r(21612),d=r(78957),u=r(83062),h=r(67337),p=r(32958),v=r.n(p),f=r(96808),m=r(85893),x=[{href:"/",title:"文章"},{href:"/favorites",title:"收藏夹"},{href:"/project",title:"开源项目"}],g=["github.io","vercel.app"],j=t()(x).call(x,function(e,n){return(0,m.jsx)("li",{className:v().navListItem,children:(0,m.jsx)(l(),{href:e.href,children:e.title})},e.href)});n.Z=function(e){return(0,m.jsx)(o.Z.Header,{className:v().antdHeader,children:(0,m.jsxs)("div",{className:v().header,children:[(0,m.jsx)("nav",{className:v().headerLeft,children:(0,m.jsx)("ul",{className:v().navList,children:j})}),(0,m.jsx)("div",{className:v().headerRight,children:(0,m.jsxs)(d.Z,{size:16,children:[(0,m.jsx)(u.Z,{title:"切换网站地址",children:(0,m.jsx)("a",{className:v().switchAddress,role:"button",tabIndex:0,"aria-label":"切换网站地址",onClick:function(e){var n=window.location,r=n.pathname,a=n.hostname,t=/github\.io/.test(a);window.location.href=new(s())(r,"https://duan602728596.".concat(g[t?1:0],"/"))},children:(0,m.jsx)(h.Z,{className:v().switchAddressIcon})})}),(0,m.jsx)("a",{className:v().githubLink,href:"https://github.com/duan602728596",target:"_blank",rel:"noopener noreferrer",children:(0,m.jsx)(f.Z,{className:"block w-full h-full",imageClassName:"block w-full h-full",avifSrc:"/images/github.avif",webpSrc:"/images/github.webp",src:"/images/github.png",alt:"github"})})]})})]})})}},96808:function(e,n,r){"use strict";var a=r(85893);n.Z=function(e){var n=e.className,r=e.imageClassName,t=e.avifSrc,i=e.webpSrc,s=e.src,c=e.alt;return(0,a.jsxs)("picture",{className:n,children:[t&&(0,a.jsx)("source",{srcSet:t,type:"image/avif"}),i&&(0,a.jsx)("source",{srcSet:i,type:"image/webp"}),(0,a.jsx)("img",{className:r,src:s,alt:c})]})}},55147:function(e,n,r){"use strict";var a=r(67294),t=r(31725),i=r(39243),s=r(85893);n.Z=function(e){return(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)(t.Z,{}),(0,s.jsx)(i.Z,{goToTop:!0,goBack:!0,children:e.children})]})}},88096:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/browser-screen-sharing",function(){return r(33438)}])},63791:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},32958:function(e){e.exports={antdHeader:"nav_antdHeader__eCvl0",header:"nav_header__y1mlw",headerLeft:"nav_headerLeft__PrT7_",headerRight:"nav_headerRight__JfqYP",navList:"nav_navList__3HXot",navListItem:"nav_navListItem__hpAdz",switchAddress:"nav_switchAddress__sVzqD",githubLink:"nav_githubLink__BDzSl",switchAddressIcon:"nav_switchAddressIcon__KLxGG"}},31305:function(e){e.exports={video:"screenSharingTest_video__pRDa2"}},33938:function(e,n,r){"use strict";r.d(n,{Z:function(){return i}});var a=r(890);function t(e,n,r,t,i,s,c){try{var l=e[s](c),o=l.value}catch(e){r(e);return}l.done?n(o):a.resolve(o).then(t,i)}function i(e){return function(){var n=this,r=arguments;return new a(function(a,i){var s=e.apply(n,r);function c(e){t(s,a,i,c,l,"next",e)}function l(e){t(s,a,i,c,l,"throw",e)}c(void 0)})}}}},function(e){e.O(0,[8610,1447,4530,8925,3791,8791,859,154,9774,2888,179],function(){return e(e.s=88096)}),_N_E=e.O()}]);