(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6576],{8252:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/web/dom-to-image",function(){return l(53158)}])},8348:function(e,t,l){"use strict";l.d(t,{Z:function(){return f}});var n=l(67294),i=l(93967),r=l.n(i),o=l(17399),s=l(18294),a=l(15063),c=l(71845),d=l(52317),m=l(83262);let g=e=>{let{componentCls:t,margin:l,marginXS:n,marginXL:i,fontSize:r,lineHeight:o}=e;return{[t]:{marginInline:n,fontSize:r,lineHeight:o,textAlign:"center",[`${t}-image`]:{height:e.emptyImgHeight,marginBottom:n,opacity:e.opacityImage,img:{height:"100%"},svg:{maxWidth:"100%",height:"100%",margin:"auto"}},[`${t}-description`]:{color:e.colorTextDescription},[`${t}-footer`]:{marginTop:l},"&-normal":{marginBlock:i,color:e.colorTextDescription,[`${t}-description`]:{color:e.colorTextDescription},[`${t}-image`]:{height:e.emptyImgHeightMD}},"&-small":{marginBlock:n,color:e.colorTextDescription,[`${t}-image`]:{height:e.emptyImgHeightSM}}}}};var h=(0,d.I$)("Empty",e=>{let{componentCls:t,controlHeightLG:l,calc:n}=e;return[g((0,m.IX)(e,{emptyImgCls:`${t}-img`,emptyImgHeight:n(l).mul(2.5).equal(),emptyImgHeightMD:l,emptyImgHeightSM:n(l).mul(.875).equal()}))]}),u=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]]);return l};let p=n.createElement(()=>{let[,e]=(0,c.ZP)(),[t]=(0,s.Z)("Empty"),l=new a.t(e.colorBgBase).toHsl().l<.5?{opacity:.65}:{};return n.createElement("svg",{style:l,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},n.createElement("title",null,(null==t?void 0:t.description)||"Empty"),n.createElement("g",{fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(24 31.67)"},n.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),n.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),n.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),n.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),n.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),n.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),n.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},n.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),n.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},null),v=n.createElement(()=>{let[,e]=(0,c.ZP)(),[t]=(0,s.Z)("Empty"),{colorFill:l,colorFillTertiary:i,colorFillQuaternary:r,colorBgContainer:o}=e,{borderColor:d,shadowColor:m,contentColor:g}=(0,n.useMemo)(()=>({borderColor:new a.t(l).onBackground(o).toHexString(),shadowColor:new a.t(i).onBackground(o).toHexString(),contentColor:new a.t(r).onBackground(o).toHexString()}),[l,i,r,o]);return n.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},n.createElement("title",null,(null==t?void 0:t.description)||"Empty"),n.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},n.createElement("ellipse",{fill:m,cx:"32",cy:"33",rx:"32",ry:"7"}),n.createElement("g",{fillRule:"nonzero",stroke:d},n.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),n.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:g}))))},null),x=e=>{var t,l,i,a,c,d,m,g;let{className:x,rootClassName:f,prefixCls:j,image:y=p,description:w,children:E,imageStyle:b,style:O,classNames:N,styles:_}=e,M=u(e,["className","rootClassName","prefixCls","image","description","children","imageStyle","style","classNames","styles"]),{getPrefixCls:T,direction:C,empty:H}=n.useContext(o.E_),z=T("empty",j),[S,Z,$]=h(z),[k]=(0,s.Z)("Empty"),I=void 0!==w?w:null==k?void 0:k.description,D=null;return D="string"==typeof y?n.createElement("img",{alt:"string"==typeof I?I:"empty",src:y}):y,S(n.createElement("div",Object.assign({className:r()(Z,$,z,null==H?void 0:H.className,{[`${z}-normal`]:y===v,[`${z}-rtl`]:"rtl"===C},x,f,null===(t=null==H?void 0:H.classNames)||void 0===t?void 0:t.root,null==N?void 0:N.root),style:Object.assign(Object.assign(Object.assign(Object.assign({},null===(l=null==H?void 0:H.styles)||void 0===l?void 0:l.root),null==H?void 0:H.style),null==_?void 0:_.root),O)},M),n.createElement("div",{className:r()(`${z}-image`,null===(i=null==H?void 0:H.classNames)||void 0===i?void 0:i.image,null==N?void 0:N.image),style:Object.assign(Object.assign(Object.assign({},b),null===(a=null==H?void 0:H.styles)||void 0===a?void 0:a.image),null==_?void 0:_.image)},D),I&&n.createElement("div",{className:r()(`${z}-description`,null===(c=null==H?void 0:H.classNames)||void 0===c?void 0:c.description,null==N?void 0:N.description),style:Object.assign(Object.assign({},null===(d=null==H?void 0:H.styles)||void 0===d?void 0:d.description),null==_?void 0:_.description)},I),E&&n.createElement("div",{className:r()(`${z}-footer`,null===(m=null==H?void 0:H.classNames)||void 0===m?void 0:m.footer,null==N?void 0:N.footer),style:Object.assign(Object.assign({},null===(g=null==H?void 0:H.styles)||void 0===g?void 0:g.footer),null==_?void 0:_.footer)},E)))};x.PRESENTED_IMAGE_DEFAULT=p,x.PRESENTED_IMAGE_SIMPLE=v;var f=x},53158:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return z}});var n=l(85893),i=l(67294),r=l(9008),o=l.n(r),s=l(66252),a=l(60279),c=l.n(a),d=l(26219),m=l(41577),g=l(86338),h=l(8348),u=l(87462),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.7L639.4 73.4c-6-6-14.2-9.4-22.7-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.6-9.4-22.6zM400 402c22.1 0 40 17.9 40 40s-17.9 40-40 40-40-17.9-40-40 17.9-40 40-40zm296 294H328c-6.7 0-10.4-7.7-6.3-12.9l99.8-127.2a8 8 0 0112.6 0l41.1 52.4 77.8-99.2a8 8 0 0112.6 0l136.5 174c4.3 5.2.5 12.9-6.1 12.9zm-94-370V137.8L790.2 326H602z"}}]},name:"file-image",theme:"filled"},v=l(36936),x=i.forwardRef(function(e,t){return i.createElement(v.Z,(0,u.Z)({},e,{ref:t,icon:p}))}),f=l(32988),j=l.n(f);let{Title:y,Paragraph:w}=s.default,E=["br","hr","img","input","param","meta","link"];var b=function(e){let[t,l]=(0,i.useState)(void 0);return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(y,{level:2,children:"代码演示"}),(0,n.jsx)(w,{children:"这是一段古诗，准备转换成图片。"}),(0,n.jsxs)(w,{className:"p-[16px] bg-[#f8f9fa]",id:"toImageText",children:[(0,n.jsx)(y,{className:j().textTitle,level:3,children:"八阵图"}),(0,n.jsx)(y,{className:j().textTitle2,level:4,children:"[唐] 杜甫"}),(0,n.jsx)("p",{children:"功盖三分国，名成八阵图。"}),(0,n.jsx)("p",{children:"江流石不转，遗恨失吞吴。"})]}),(0,n.jsx)("div",{className:"mb-[16px] text-right",children:(0,n.jsx)(g.ZP,{type:"primary",icon:(0,n.jsx)(x,{}),onClick:function(e){let t=document.getElementById("toImageText"),n=new Blob(`<svg xmlns="http://www.w3.org/2000/svg">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml">${(function e(t){let l="";if("#text"!==t.nodeName){let n=t.nodeName.toLowerCase(),i=function(e,t){let l=window.getComputedStyle(e),n=[];for(let e of t){let t=function(e){let t=e.split(/-/g),l="";for(let e=0,n=t.length;e<n;e++){let n=t[e];0===e?l+=n:l+=`${n[0].toLocaleUpperCase()}${n.substr(1)}`}return l}(e),i=l[t];"fontFamily"===t&&(i=i.replace(/"/g,"")),n.push(`${e}: ${i};`)}return n.join(" ")}(t,["box-sizing","padding","margin","width","height","font-size","font-family","border-radius","color","text-align","background-color"]);if(l+=`<${n} style="${i}">`,!E.includes(n)){let i=t.childNodes;for(let t=0,n=i.length;t<n;t++)l+=e(i[t]);l+=`</${n}>`}}else l+=t.data;return l})(t)}</div>
  </foreignObject>
</svg>`.split(""),{type:"image/svg+xml;charset=utf-8"});l(window.URL.createObjectURL(n))},children:"生成图片"})}),(0,n.jsx)("div",{children:t?(0,n.jsx)("img",{className:"w-full h-[186px]",src:t}):(0,n.jsx)(h.Z,{description:"图片预览"})})]})},O=l(11151);function N(e){let t={code:"code",pre:"pre",...(0,O.a)(),...e.components};return(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",children:'/* 如何转换成图片 */\nconst html = `\n  <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">\n    <foreignObject width="100%" height="100%">\n      <div xmlns="http://www.w3.org/1999/xhtml">Hello, world!</div>\n    </foreignObject>\n  </svg>`;\n\nconst svg = new Blob(html.split(\'\'), {\n  type: \'image/svg+xml;charset=utf-8\'\n});\n\nconst url = window.URL.createObjectURL(svg); // 生成的图片地址\n'})})}function _(e={}){let{wrapper:t}={...(0,O.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(N,{...e})}):N(e)}let{Title:M,Paragraph:T,Text:C}=s.default;var H=function(e){return(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(M,{children:"用JavaScript将DOM绘制成图片"}),(0,n.jsxs)(T,{children:["之前看到了一个动画，",(0,n.jsx)(m.Z,{href:"https://jdc.jd.com/lab/2018-ae2css/washer/",children:"https://jdc.jd.com/lab/2018-ae2css/washer/"}),"，就琢磨着怎么简单实现一下。要做的，就是将DOM的内容原原本本复制，并绘制成图片。"]}),(0,n.jsx)(M,{level:2,children:"实现原理"}),(0,n.jsxs)(T,{children:["SVG的",(0,n.jsx)(m.Z,{href:"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/foreignObject",children:"foreignObject"}),"标签，可以包含html片段，这样就可以将整个DOM片段转换成SVG。"]}),(0,n.jsxs)(T,{children:["不过要注意的是，",(0,n.jsx)(C,{className:c().textWarning,type:"warning",strong:!0,children:"如果样式在样式表内，则svg里面对应的class是无效的"}),"，Chrome下可以把包含样式的style标签内容一并加进去，然后就可以通过类名来设置样式了，也可以通过遍历样式并添加",(0,n.jsx)(C,{strong:!0,underline:!0,children:'style="key: value;"'}),"使样式生效。可以使用",(0,n.jsx)(C,{strong:!0,underline:!0,children:"window.getComputedStyle"}),"来获取DOM的样式。 如果嫌麻烦，还可以使用",(0,n.jsx)(m.Z,{href:"https://github.com/niklasvh/html2canvas",children:"html2canvas"}),"库。"]}),(0,n.jsx)(T,{children:"SVG内DOM节点的xmlns属性不能省略。"}),(0,n.jsx)(_,{}),(0,n.jsx)(b,{})]})};function z(e){return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)(o(),{children:[(0,n.jsx)("title",{children:"用JavaScript将DOM绘制成图片"}),(0,n.jsx)("meta",{name:"keywords",content:"前端, js, javascript, DOM转图片, canvas, svg"}),(0,n.jsx)("meta",{name:"description",content:"用Javascript将DOM绘制成图片"})]}),(0,n.jsx)(H,{})]})}},94914:function(e,t,l){"use strict";var n=l(85893),i=l(73935),r=l(39332),o=l(29155),s=l(86338),a=l(70612),c=l(30448),d=l(76467),m=l(1294),g=l.n(m);let{BackTop:h}=o.default;t.Z=function(e){let t=(0,r.useRouter)();return[(0,n.jsxs)("div",{className:g().main,children:[e.goBack?(0,n.jsx)("div",{className:"mb-[16px] text-right",children:(0,n.jsxs)(s.ZP,{onClick:function(e){t.push("/")},children:[(0,n.jsx)(c.Z,{className:"mr-[6px]"}),"返回"]})}):null,e?.children]},"main"),e?.goToTop?(0,n.jsx)(d.default,{children:"object"==typeof document?(0,i.createPortal)((0,n.jsx)(h,{type:"primary",icon:(0,n.jsx)(a.Z,{}),title:"返回顶部",tabIndex:0,role:"button","aria-label":"返回顶部"}),document.body):null},"backTop"):null]}},26219:function(e,t,l){"use strict";var n=l(85893),i=l(66252),r=l(94914);t.Z=function(e){return(0,n.jsx)(r.Z,{goToTop:!0,goBack:!0,children:(0,n.jsx)(i.default,{children:e.children})})}},1294:function(e){e.exports={main:"main_main__IZXSv",goToTop:"main_goToTop__Py8c8"}},60279:function(e){e.exports={textWarning:"article_textWarning__aYEh3"}},32988:function(e){e.exports={textTitle:"demo_textTitle__LVjfh",textTitle2:"demo_textTitle2__Ratfd"}}},function(e){e.O(0,[6338,5361,2888,9774,179],function(){return e(e.s=8252)}),_N_E=e.O()}]);